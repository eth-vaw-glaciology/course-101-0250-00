<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <script src="/libs/lunr/lunr.min.js"></script> <script src="/libs/lunr/lunr_index.js"></script> <script src="/libs/lunr/lunrclient.min.js"></script> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <link rel=stylesheet  href="/css/custom.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/assets/favicon.png"> <title>Lecture 1</title> <style> .content {max-width: 50rem} </style> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <img src="/assets/vaw_logo.png" style="width: 180px; height: auto; display: inline"> <div style="font-weight: margin-bottom: 0.5em"><a href="/"> Fall 2024</a> <span style="opacity: 0.7;">| <a href="https://www.vorlesungen.ethz.ch/Vorlesungsverzeichnis/lerneinheit.view?semkez=2024W&ansicht=KATALOGDATEN&lerneinheitId=182481&lang=en"> ETHZ 101-0250-00</a></span></div> <br> <h1><a href="/">Solving partial differential equations in parallel on GPUs</a></h1> <div style="line-height:18px; font-size: 15px; opacity: 0.85">by &nbsp; <a href="https://vaw.ethz.ch/en/people/person-detail.MjcwOTYw.TGlzdC8xOTYxLDE1MTczNjI1ODA=.html">Ludovic R√§ss</a>, &nbsp; <a href="https://vaw.ethz.ch/en/personen/person-detail.html?persid=124402">Mauro Werder</a>, &nbsp; <a href="https://www.cscs.ch/about/staff/">Samuel Omlin</a> & <br> <a href="https://vaw.ethz.ch/en/people/person-detail.MzAwMjIy.TGlzdC8xOTYxLDE1MTczNjI1ODA=.html">Ivan Utkin</a> </div> </div> <br> <style> </style> <nav class=sidebar-nav  style="opacity: 0.9; margin-bottom: 1.2cm;"> <a class="sidebar-nav-item " href="/"><b>Welcome</b></a> <a class="sidebar-nav-item " href="/logistics/">Logistics</a> <a class="sidebar-nav-item " href="/homework/">Homeworks</a> <a class="sidebar-nav-item " href="/software_install/">Software install</a> <a class="sidebar-nav-item " href="/extras/">Extras</a> <br> <div class=course-section >Part 1 ‚Äì Introduction</div> <a class="sidebar-nav-item active" href="/lecture1/">Lecture 1 ‚Äì Why Julia GPU</a> <a class="sidebar-nav-item " href="/lecture2/">Lecture 2 ‚Äì PDEs & physical processes</a> <a class="sidebar-nav-item " href="/lecture3/">Lecture 3 ‚Äì Solving elliptic PDEs</a> <div class=course-section >Part 2 ‚Äì Solving PDEs on GPUs</div> <a class="sidebar-nav-item " href="/lecture4/">Lecture 4 ‚Äì Porous convection</a> <a class="sidebar-nav-item " href="/lecture5/">Lecture 5 ‚Äì Parallel computing</a> <a class="sidebar-nav-item " href="/lecture6/">Lecture 6 ‚Äì GPU computing</a> <div class=course-section >Part 3 ‚Äì Multi-GPU computing (projects)</div> <a class="sidebar-nav-item " href="/lecture7/">Lecture 7 ‚Äì xPU computing</a> <a class="sidebar-nav-item " href="/lecture8/">Lecture 8 ‚Äì Julia MPI & multi-xPU</a> <a class="sidebar-nav-item " href="/lecture9/">Lecture 9 ‚Äì Multi-xPU & Projects</a> <a class="sidebar-nav-item " href="/lecture10/">Lecture 10 ‚Äì Advanced optimisations</a> <div class=course-section >Final Projects</div> <a class="sidebar-nav-item " href="/final_proj/">Infos about final projects</a> </nav> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text > <input type=submit  value=Search  formaction="/search/index.html"> </form> <br> <br> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id=lecture_1 ><a href="#lecture_1" class=header-anchor >Lecture 1</a></h1> <p><strong>Welcome to ETH&#39;s course 101-0250-00L on solving partial differential equations &#40;PDEs&#41; in parallel on graphical processing units &#40;GPUs&#41; with the Julia language.</strong></p> <blockquote> <p><strong>Agenda</strong><br />üí° Welcome words &amp; The small print<br />üìö Why GPU computing<br />üíª Intro to Julia<br />üöß Exercises:</p> <ul> <li><p>Numerical solutions</p> <li><p>Predictive modelling</p> <li><p>Visualisation</p> </ul> </blockquote> <hr /> <p><a id=content  class=anchor ></a> <strong>Content</strong></p> <div class=franklin-toc ><ol><li><a href="#lecture_1">Lecture 1</a><li><a href="#solving_partial_differential_equations_in_parallel_on_gpus">Solving partial differential equations in parallel on GPUs</a><ol><li><a href="#the_team">The Team</a><li><a href="#logistics">Logistics</a><li><a href="#grading">Grading</a><li><a href="#computing">Computing</a><li><a href="#summary">Summary</a></ol><li><a href="#why_solve_pdes_on_gpus_the_tool_for_the_job">Why solve PDEs on GPUs? The tool for the job</a><ol><li><a href="#why_solve_pdes_on_gpus">Why solve PDEs on GPUs?</a></ol><li><a href="#tool_for_the_job_introduction_to_julia">Tool for the job: introduction to Julia</a><ol><li><a href="#aside_1_jupyter_notebooks">Aside 1: Jupyter Notebooks</a><li><a href="#aside_2_what_is_your_previous_programming_experience">Aside 2: What is your previous programming experience?</a><li><a href="#the_julia_programming_language">The Julia programming language</a><li><a href="#variables_assignments_and_types_5min">Variables, assignments, and types &#91;5min&#93;</a><li><a href="#array_exercises_15min">Array exercises &#91;15min&#93;</a><li><a href="#control_flow_10min">Control flow &#91;10min&#93;</a><li><a href="#functions_15min">Functions &#91;15min&#93;</a><li><a href="#functions_multiple_dispatch_demo">Functions: Multiple dispatch demo</a><li><a href="#modules_and_packages_5min">Modules and packages &#91;5min&#93;</a><li><a href="#this_concludes_the_rapid_julia_tour">This concludes the rapid Julia tour</a></ol><li><a href="#exercises_-_lecture_1">Exercises - lecture 1</a><ol><li><a href="#exercise_1_car_travel">Exercise 1 ‚Äî <strong>Car travel</strong></a><li><a href="#exercise_2_car_travel_in_2_dimensions">Exercise 2 ‚Äî <strong>Car travel in 2 dimensions</strong></a><li><a href="#exercise_3_volcanic_bomb">Exercise 3 ‚Äî <strong>Volcanic bomb</strong></a><li><a href="#exercise_4_optional_orbital_around_a_centre_of_mass">Exercise 4 <em>&#40;optional&#41;</em> ‚Äî <strong>Orbital around a centre of mass</strong></a><li><a href="#exercise_5_optional_many_volcanic_bombs">Exercise 5 <em>&#40;optional&#41;</em> ‚Äî <strong>Many volcanic bombs</strong></a></ol></ol></div> <p><a href="#exercises_-_lecture_1"><em>üëâ get started with exercises</em></a></p> <div class=note ><div class=title >üí° Note</div> <div class=messg >This week&#39;s homework have to be handed in as Jupyter notebook. See <a href="/software_install/#exercises_and_homework">here</a> for details.</div></div> <hr /> <h1 id=solving_partial_differential_equations_in_parallel_on_gpus ><a href="#solving_partial_differential_equations_in_parallel_on_gpus" class=header-anchor >Solving partial differential equations in parallel on GPUs</a></h1> <h2 id=the_team ><a href="#the_team" class=header-anchor >The Team</a></h2> <ul> <li><p>Ludovic R√§ss ‚Äî <em>the good</em></p> <li><p>Samuel Omlin ‚Äî <em>the bad</em></p> <li><p>Mauro Werder ‚Äî <em>the ugly</em></p> <li><p>Ivan Utkin ‚Äî <em>the talking head</em></p> <li><p>You Wu ‚Äî <em>the teaching assistant</em></p> </ul> <h2 id=logistics ><a href="#logistics" class=header-anchor >Logistics</a></h2> <p>All the information should be available on the course&#39;s website:<br /><a href="https://pde-on-gpu.vaw.ethz.ch">https://pde-on-gpu.vaw.ethz.ch</a></p> <blockquote> <p>If something is missing, let us know so we can add it, or <em>even better</em>, submit a <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests/">pull request</a> to <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/">the course&#39;s repository</a></p> </blockquote> <h3 id=discussion_help ><a href="#discussion_help" class=header-anchor >Discussion &amp; help</a></h3> <ul> <li><p>We use the chat on Element as the main communication channel for the course</p> <li><p>Communication between students is encouraged</p> <li><p>Join <a href="https://chat.ethz.ch/">Element &#40;https://chat.ethz.ch/&#41;</a> by logging in with you NETHZ username &amp; password</p> <ul> <li><p>Login link is available on <a href="https://moodle-app2.let.ethz.ch/course/view.php?id&#61;23586">Moodle</a></p> <li><p>Join the <em><strong>General</strong></em> room for course-related information</p> <li><p>Join the <em><strong>Helpdesk</strong></em> room for exercises Q&amp;A</p> </ul> </ul> <h2 id=grading ><a href="#grading" class=header-anchor >Grading</a></h2> <p>All homework assignements can be done either alone or in groups of two. However, <strong>note that every student has to hand in a personal version of the homework</strong>.</p> <ul> <li><p>6 Weekly exercises in Part 1 and Part 2 of the course as homework ‚Äî <strong>30&#37;</strong></p> <ul> <li><p>Best five out of six are graded</p> </ul> <li><p>Consolidation project, developed during Part 3 of the course ‚Äî <strong>35&#37;</strong></p> <li><p>Final project ‚Äî <strong>35&#37;</strong></p> </ul> <h2 id=computing ><a href="#computing" class=header-anchor >Computing</a></h2> <p>Bring your laptop to all lectures&#33;</p> <ul> <li><p>Who has access to an Nvidia / AMD GPU?</p> <li><p>What operating system are you on?</p> </ul> <p>In the first two lectures we will use JupyterHub. Later you will setup a personal Julia installation.</p> <h2 id=summary ><a href="#summary" class=header-anchor >Summary</a></h2> <ul> <li><p>Almost all information is available on <a href="https://pde-on-gpu.vaw.ethz.ch">https://pde-on-gpu.vaw.ethz.ch</a></p> <li><p>Join <a href="https://chat.ethz.ch/">Element &#40;https://chat.ethz.ch/&#41;</a></p> <li><p>If something important is missing, let us know or make a PR</p> </ul> <blockquote> <p><strong>Suggestion:</strong> <br />Bookmark <a href="hhttps://pde-on-gpu.vaw.ethz.ch">https://pde-on-gpu.vaw.ethz.ch</a></p> </blockquote> <p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p> <h1 id=why_solve_pdes_on_gpus_the_tool_for_the_job ><a href="#why_solve_pdes_on_gpus_the_tool_for_the_job" class=header-anchor >Why solve PDEs on GPUs? The tool for the job</a></h1> <h2 id=why_solve_pdes_on_gpus ><a href="#why_solve_pdes_on_gpus" class=header-anchor >Why solve PDEs on GPUs?</a></h2> <center> <video width="80%" autoplay loop controls src="../assets/literate_figures/l1_porous_convection_2D.mp4"/> </center> <h3 id=a_brief_intro_about_gpu_computing ><a href="#a_brief_intro_about_gpu_computing" class=header-anchor >A brief intro about GPU computing:</a></h3> <ul> <li><p>Why we do it</p> <li><p>Why it is cool &#40;in Julia&#41;</p> <li><p>Examples from current research</p> </ul> <h3 id=propaganda ><a href="#propaganda" class=header-anchor >Propaganda</a></h3> <h4 id=why_we_do_it ><a href="#why_we_do_it" class=header-anchor >Why we do it</a></h4> <p>Predict the evolution of natural and engineered systems.</p> <p><img src="../assets/literate_figures/l1_ice2.png" alt=ice2  /></p> <p><em>e.g. ice cap evolution, stress distribution, etc...</em></p> <p>Physical processes that describe those systems are <strong>complex</strong> and often <strong>nonlinear</strong></p> <ul> <li><p>no or very limited analytical solution is available</p> </ul> <p>üëâ a numerical approach is required to solve the mathematical model</p> <p>A numerical solution means solving a system of &#40;coupled&#41; differential equations</p> \[ \mathbf{mathematical ~ model ~ ‚Üí ~ discretisation ~ ‚Üí ~ solution}\\ \frac{‚àÇC}{‚àÇt} = ... ~ ‚Üí ~ \frac{\texttt{C}^{i+1} - \texttt{C}^{i}}{\texttt{‚àÜt}} = ... ~ ‚Üí ~ \texttt{C} = \texttt{C} + \texttt{‚àÜt} \cdot ... \] <p>Solving PDEs is computationally demanding</p> <ul> <li><p>ODEs - scalar equations</p> </ul> \[ \frac{‚àÇC}{‚àÇt} = -\frac{(C-C_{eq})}{Œæ} \] <p>but...</p> <ul> <li><p>PDEs - involve vectors &#40;and tensors&#41; üëâ local gradients &amp; neighbours</p> </ul> \[ \frac{‚àÇC}{‚àÇt} = D~ \left(\frac{‚àÇ^2C}{‚àÇx^2} + \frac{‚àÇ^2C}{‚àÇy^2} \right) \] <p>Computational costs increase</p> <ul> <li><p>with complexity &#40;e.g. multi-physics, couplings&#41;</p> <li><p>with dimensions &#40;3D tensors...&#41;</p> <li><p>upon refining spatial and temporal resolution</p> </ul> <center> <video width="80%" autoplay loop controls src="../assets/literate_figures/l1_Stokes2D_vep.mp4"/> </center> <p>Use <strong>parallel computing</strong> to address this:</p> <ul> <li><p>The &quot;memory wall&quot; in ~ 2004</p> <li><p>Single-core to multi-core devices</p> </ul> <p><img src="../assets/literate_figures/l1_mem_wall.png" alt=mem_wall  /></p> <p>GPUs are <em>massively</em> parallel devices</p> <ul> <li><p>SIMD machine &#40;programmed using threads - SPMD&#41; &#40;<a href="https://safari.ethz.ch/architecture/fall2020/lib/exe/fetch.php?media&#61;onur-comparch-fall2020-lecture24-simdandgpu-afterlecture.pdf">more</a>&#41;</p> <li><p>Further increases the Flop vs Bytes gap</p> </ul> <p><img src="../assets/literate_figures/l1_cpu_gpu_evo.png" alt=cpu_gpu_evo  /></p> <p>üëâ We are memory bound: requires to re-think the numerical implementation and solution strategies</p> <h4 id=why_it_is_cool ><a href="#why_it_is_cool" class=header-anchor >Why it is cool</a></h4> <p><img src="../assets/literate_figures/l1_julia-gpu.png" alt=julia-gpu  /></p> <h4 id=gpu_are_cool ><a href="#gpu_are_cool" class=header-anchor >GPU are cool</a></h4> <ul> <li><p>Price vs Performance; Close to <strong>1.5TB/s</strong> memory throughput &#40;nonlinear diffusion&#41; that one can achieve üöÄ</p> </ul> <p><img src="../assets/literate_figures/l1_perf_gpu.png" alt=perf_gpu  /></p> <ul> <li><p>Availability &#40;less fight for resources&#41;; Still not many applications run on GPUs</p> <li><p>Workstation turns into a personal Supercomputers; GPU vs CPUs peak memory bandwidth: theoretical 10x &#40;practically more&#41;</p> </ul> <p><img src="../assets/literate_figures/l1_titan_node.jpg" alt=titan_node  /></p> <h4 id=julia_is_cool ><a href="#julia_is_cool" class=header-anchor >Julia is cool</a></h4> <p>Solution to the &quot;two-language problem&quot;</p> <ul> <li><p>Single code for prototyping and production</p> </ul> <p><img src="../assets/literate_figures/l1_two_lang.png" alt=two_lang  /></p> <p>Backend agnostic:</p> <ul> <li><p>Single code to run on single CPU or thousands of GPUs</p> <li><p>Single code to run on various CPUs &#40;x86, Power9, ARM&#41; <br />and GPUs &#40;Nvidia, AMD&#41;</p> </ul> <p>Interactive:</p> <ul> <li><p>No need for 3rd-party visualisation software</p> <li><p>Debugging and interactive REPL mode</p> <li><p>Efficient for development</p> </ul> <h4 id=examples_from_current_research ><a href="#examples_from_current_research" class=header-anchor >Examples from current research</a></h4> <ul> <li><p><a href="https://github.com/omlins/ParallelStencil.jl#miniapp-content">ParallelStencil <em>miniapps</em></a></p> <li><p><a href="https://github.com/luraess/julia-parallel-course-EGU21#greenlands-ice-cap-evolution">Ice-flow modelling</a></p> <li><p><a href="https://ptsolvers.github.io/GPU4GEO/software/">GPU4GEO - <em>Frontier GPU multi-physics solvers</em></a></p> <li><p><a href="https://github.com/PTsolvers/PseudoTransientAdjoint.jl#3d-hydro-mechanically-constrained-inversion">3D hydro-mechanical inversions</a></p> <li><p><a href="https://github.com/luraess/ParallelRandomFields.jl#parallelrandomfieldsjl">3D Random fields</a></p> <li><p>more ...</p> </ul> <p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p> <h1 id=tool_for_the_job_introduction_to_julia ><a href="#tool_for_the_job_introduction_to_julia" class=header-anchor >Tool for the job: introduction to Julia</a></h1> <p><img src="../assets/literate_figures/l1_julia-logo.svg" alt=julia-logo  /></p> <h2 id=aside_1_jupyter_notebooks ><a href="#aside_1_jupyter_notebooks" class=header-anchor >Aside 1: Jupyter Notebooks</a></h2> <p>These slides are a <a href="https://jupyter.org/">Jupyter notebook</a>; a browser-based computational notebook.</p> <div class=note ><div class=title >üí° Note</div> <div class=messg >You can follow the lecture along live from the Moodle-based <a href="https://moodle-app2.let.ethz.ch/mod/lti/view.php?id&#61;1105076">JupyterHub</a> server.</div></div> <p>Code cells are executed by putting the cursor into the cell and hitting <code>shift &#43; enter</code>. For more info see the <a href="https://jupyter-notebook.readthedocs.io/en/stable/">documentation</a>.</p> <h2 id=aside_2_what_is_your_previous_programming_experience ><a href="#aside_2_what_is_your_previous_programming_experience" class=header-anchor >Aside 2: What is your previous programming experience?</a></h2> <ol> <li><p>Julia</p> <li><p>Matlab, Python, Octave, R, ...</p> <li><p>C, Fortran, ...</p> <li><p>Pascal, Java, C&#43;&#43;, ...</p> <li><p>Lisp, Haskell, ...</p> <li><p>Assembler</p> <li><p>Coq, Brainfuck, ...</p> </ol> <p><a href="https://docs.google.com/forms/d/1ROOY4QLaL-_vM8eXKhCp72FCPfaTshfCrR2syv562BE/edit#responses">Survey</a></p> <h2 id=the_julia_programming_language ><a href="#the_julia_programming_language" class=header-anchor >The Julia programming language</a></h2> <p><a href="https://julialang.org/">Julia</a> is a modern, interactive, and high performance programming language. It&#39;s a general purpose language with a bend on technical computing.</p> <p><img src="../assets/literate_figures/l1_julia-logo-repl.png" alt=julia-logo  /></p> <ul> <li><p>first released in 2012</p> <li><p>reached version 1.0 in 2018</p> <li><p>current version 1.10.5 &#40;09.2024&#41; &#91;ETH&#39;s JupyterHub is on 1.10.2&#93;</p> <li><p>thriving community, for instance there are currently around 11000 <a href="https://juliahub.com/ui/Packages">packages registered</a></p> </ul> <h3 id=what_does_julia_look_like ><a href="#what_does_julia_look_like" class=header-anchor >What does Julia look like</a></h3> <p>An example solving the Lorenz system of ODEs:</p> <pre><code class=language-julia >using Plots

function lorenz&#40;x&#41;
    œÉ &#61; 10
    Œ≤ &#61; 8/3
    œÅ &#61; 28
    &#91;œÉ*&#40;x&#91;2&#93;-x&#91;1&#93;&#41;,
     x&#91;1&#93;*&#40;œÅ-x&#91;3&#93;&#41; - x&#91;2&#93;,
     x&#91;1&#93;*x&#91;2&#93; - Œ≤*x&#91;3&#93;&#93;
end

# integrate dx/dt &#61; lorenz&#40;t,x&#41; numerically for 500 steps
dt &#61; 0.01
x‚ÇÄ &#61; &#91;2.0, 0.0, 0.0&#93;
out &#61; zeros&#40;3, 500&#41;
out&#91;:,1&#93; &#61; x‚ÇÄ
for i&#61;2:size&#40;out,2&#41;
    out&#91;:,i&#93; &#61; out&#91;:,i-1&#93; &#43; lorenz&#40;out&#91;:,i-1&#93;&#41; * dt
end</code></pre> <p>Yes, this takes a bit of time... Julia is Just-Ahead-of-Time compiled. I.e. Julia is compiling.</p> <p>And its solution plotted</p> <pre><code class=language-julia >plot&#40;out&#91;1,:&#93;, out&#91;2,:&#93;, out&#91;3,:&#93;&#41;</code></pre>
<p><img src="../assets/literate_figures/l1_lorenz.png" alt=lorenz  /></p>
<h3 id=julia_in_brief ><a href="#julia_in_brief" class=header-anchor >Julia in brief</a></h3>
<p>Julia 1.0 released 2018, now at version 1.10</p>
<p>Features:</p>
<ul>
<li><p>general purpose language with a focus on technical computing</p>

<li><p>dynamic language</p>
<ul>
<li><p>interactive development</p>

<li><p>garbage collection</p>

</ul>

<li><p>good performance on par with C &amp; Fortran</p>
<ul>
<li><p>just-ahead-of-time compiled via LLVM</p>

<li><p>No need to vectorise: for loops are fast</p>

</ul>

<li><p>multiple dispatch</p>

<li><p>user-defined types are as fast and compact as built-ins</p>

<li><p>Lisp-like macros and other metaprogramming facilities</p>

<li><p>designed for parallelism and distributed computation</p>

<li><p>good inter-op with other languages</p>

</ul>
<h3 id=the_two_language_problem ><a href="#the_two_language_problem" class=header-anchor >The two language problem</a></h3>
<p><strong>One language to prototype   ‚Äì  one language for production</strong></p>
<ul>
<li><p>example from Ludovic&#39;s past: prototype in Matlab, production in CUDA-C</p>

</ul>
<p><strong>One language for the users  ‚Äì  one language for under-the-hood</strong></p>
<ul>
<li><p>Numpy &#40;python ‚Äì C&#41;</p>

<li><p>machine-learning: PyTorch, TensorFlow</p>

</ul>
<p>Code stats for PyTorch and TensorFlow: <img src="../assets/literate_figures/l1_ml.png" alt="" /></p>
<h3 id=the_two_language_problem__2 ><a href="#the_two_language_problem__2" class=header-anchor >The two language problem</a></h3>
<p>Prototype/interface language:</p>
<ul>
<li><p>easy to learn and use</p>

<li><p>interactive</p>

<li><p>productive</p>

<li><p>‚Äì&gt; <em>but slow</em></p>

<li><p>Examples: Python, Matlab, R, IDL...</p>

</ul>
<p>Production/fast language:</p>
<ul>
<li><p>fast</p>

<li><p>‚Äì&gt; <em>but</em> complicated/verbose/not-interactive/etc</p>

<li><p>Examples: C, C&#43;&#43;, Fortran, Java...</p>

</ul>
<h3 id=julia_solves_the_two-language_problem ><a href="#julia_solves_the_two-language_problem" class=header-anchor >Julia solves the two-language problem</a></h3>
<p>Julia is:</p>
<ul>
<li><p>easy to learn and use</p>

<li><p>interactive</p>

<li><p>productive</p>

</ul>
<p>and also:</p>
<ul>
<li><p>fast</p>

</ul>
<p>Code stats for PyTorch, TensorFlow and Flux.jl: <img src="../assets/literate_figures/l1_flux-vs-tensorflow.png" alt="" /></p>
<h3 id=lets_get_our_hands_dirty ><a href="#lets_get_our_hands_dirty" class=header-anchor >Let&#39;s get our hands dirty&#33;</a></h3>
<p>Fire up your JupyterHub, either via the <a href="https://moodle-app2.let.ethz.ch/mod/lti/view.php?id&#61;1105076">Moodle page</a>, or directly via <a href="https://jhub-let-04-23586.ethz.ch/hub/home">this link</a>.</p>
<p>&#91;Brief explanation on JupyterHub&#93;</p>
<p>This notebook you can get onto your JupyterHub by</p>
<ul>
<li><p>opening the hub</p>

<li><p>opening a terminal</p>

<li><p>pasting into the terminal <code>wget https://people.ee.ethz.ch/~werderm/l1.ipynb</code></p>

</ul>
<p>Open it by clicking on it in the sidebar.</p>
<h3 id=lets_get_our_hands_dirty__2 ><a href="#lets_get_our_hands_dirty__2" class=header-anchor >Let&#39;s get our hands dirty&#33;</a></h3>
<p>We will now look at</p>
<ul>
<li><p>variables and types</p>

<li><p>control flow</p>

<li><p>functions</p>

<li><p>modules and packages</p>

</ul>
<p>The documentation of Julia is good and can be found at <a href="https://docs.julialang.org">https://docs.julialang.org</a>; although for learning it might be a bit terse...</p>
<p>There are also tutorials, see <a href="https://julialang.org/learning/">https://julialang.org/learning/</a>.</p>
<p>Furthermore, documentation can be gotten with <code>?xyz</code></p>
<pre><code class=language-julia ># ?cos</code></pre>
<h2 id=variables_assignments_and_types_5min ><a href="#variables_assignments_and_types_5min" class=header-anchor >Variables, assignments, and types &#91;5min&#93;</a></h2>
<p><a href="https://docs.julialang.org/en/v1/manual/variables/">https://docs.julialang.org/en/v1/manual/variables/</a></p>
<pre><code class=language-julia >a &#61; 4
b &#61; &quot;a string&quot;
c &#61; b # now b and c bind to the same value</code></pre>
<p>Conventions:</p>
<ul>
<li><p>variables are &#40;usually&#41; lowercase, words can be separated by <code>_</code></p>

<li><p>function names are lowercase</p>

<li><p>modules, packages and types are in CamelCase</p>

</ul>
<h3 id=variables_unicode ><a href="#variables_unicode" class=header-anchor >Variables: Unicode</a></h3>
<p>From <a href="https://docs.julialang.org/en/v1/manual/variables/">https://docs.julialang.org/en/v1/manual/variables/</a>:</p>
<p>Unicode names &#40;in UTF-8 encoding&#41; are allowed:</p>
<pre><code class=language-julia >julia&gt; Œ¥ &#61; 0.00001
1.0e-5

julia&gt; ÏïàÎÖïÌïòÏÑ∏Ïöî &#61; &quot;Hello&quot;
&quot;Hello&quot;</code></pre>
<p>In the Julia REPL and several other Julia editing environments, you can type many Unicode math symbols by typing the backslashed LaTeX symbol name followed by tab. For example, the variable name <code>Œ¥</code> can be entered by typing <code>\delta</code>-<em>tab</em>, or even <code>Œ±ÃÇ‚ÅΩ¬≤‚Åæ</code> by <code>\alpha</code>-<em>tab</em>-<code>\hat</code>- <em>tab</em>-<code>\^&#40;2&#41;</code>-<em>tab</em>. &#40;If you find a symbol somewhere, e.g. in someone else&#39;s code, that you don&#39;t know how to type, the REPL help will tell you: just type <code>?</code> and then paste the symbol.&#41;</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=basic_datatypes ><a href="#basic_datatypes" class=header-anchor >Basic datatypes</a></h3>
<ul>
<li><p>numbers &#40;Ints, Floats, Complex, etc.&#41;</p>

<li><p>strings</p>

<li><p>tuples</p>

<li><p>arrays</p>

<li><p>dictionaries</p>

</ul>
<pre><code class=language-julia >1     # 64 bit integer &#40;or 32 bit if on a 32-bit OS&#41;
1.5   # Float64
1//2  # Rational</code></pre>
<pre><code class=language-julia >typeof&#40;1.5&#41;</code></pre>
<pre><code class=language-julia >&quot;a string&quot;, &#40;1, 3.5&#41; # and tuple</code></pre>
<pre><code class=language-julia >&#91;1, 2, 3,&#93; # array of eltype Int</code></pre>
<pre><code class=language-julia >Dict&#40;&quot;a&quot;&#61;&gt;1, &quot;b&quot;&#61;&gt;cos&#41;</code></pre>
<h2 id=array_exercises_15min ><a href="#array_exercises_15min" class=header-anchor >Array exercises &#91;15min&#93;</a></h2>
<p>We will use arrays extensively in this course.</p>
<p>Datatypes belonging to AbstactArrays:</p>
<ul>
<li><p><code>Array</code> &#40;with aliases <code>Vector</code>, <code>Matrix</code>&#41;</p>

<li><p><code>Range</code></p>

<li><p>GPU arrays, static arrays, etc</p>

</ul>
<p>Task: assign two vectors to <code>a</code>, and <code>b</code> and the concatenate them using <code>;</code>:</p>
<pre><code class=language-julia >a &#61; &#91;2, 3&#93;
b &#61; ...
&#91; ; &#93;</code></pre>
<p>Add new elements to the end of Vector <code>b</code> &#40;hint look up the documentation for <code>push&#33;</code>&#41;</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=array_exercises ><a href="#array_exercises" class=header-anchor >Array exercises</a></h3>
<p>Concatenate a Range, say <code>1:10</code>, with a Vector, say &#91;4,5&#93;:</p>
<pre><code class=language-julia >&#91;  ;  &#93;</code></pre>
<p>Make a random array of size &#40;3,3&#41;.  Look up <code>?rand</code>.  Assign it to <code>a</code></p>
<pre><code class=language-julia >#</code></pre>
<h3 id=array_exercise_indexing ><a href="#array_exercise_indexing" class=header-anchor >Array exercise: indexing</a></h3>
<p>Access element <code>&#91;1,2&#93;</code> and <code>&#91;2,1&#93;</code> of Matrix <code>a</code> &#40;hint use &#91;&#93;&#41;:</p>
<pre><code class=language-julia >a&#91; ... &#93;, a&#91; ... &#93;</code></pre>
<p>Put those two values into a vector</p>
<pre><code class=language-julia >#</code></pre>
<p>Linear vs Cartesian indexing, access the first element:</p>
<pre><code class=language-julia >a&#91;1&#93;
a&#91;1,1&#93;</code></pre>
<p>Access the last element &#40;look up <code>?end</code>&#41; both with linear and Cartesian indices</p>
<pre><code class=language-julia >a&#91;...&#93;
a&#91;..., ...&#93;</code></pre>
<h3 id=array_exercise_indexing_by_ranges ><a href="#array_exercise_indexing_by_ranges" class=header-anchor >Array exercise: indexing by ranges</a></h3>
<p>Access the last row of <code>a</code> &#40;hint use <code>1:end</code>&#41;</p>
<pre><code class=language-julia >a&#91;... , ...&#93;</code></pre>
<p>Access a 2x2 sub-matrix</p>
<pre><code class=language-julia >a&#91; &#93;</code></pre>
<h3 id=array_exercises_variable_bindings_and_views ><a href="#array_exercises_variable_bindings_and_views" class=header-anchor >Array exercises: variable bindings and views</a></h3>
<p>What do you make of</p>
<pre><code class=language-julia >a &#61; &#91;1 4; 3 4&#93; # note, this is another way to define a Matrix
c &#61; a
a&#91;1, 2&#93; &#61; 99
@assert c&#91;1,2&#93; &#61;&#61; a&#91;1,2&#93;</code></pre>
<p>Type your answer here &#40;to start editing, double click into this cell.  When done shift&#43;enter&#41;:</p>
<h3 id=array_exercises_variable_bindings_and_views__2 ><a href="#array_exercises_variable_bindings_and_views__2" class=header-anchor >Array exercises: variable bindings and views</a></h3>
<p>An assignment <em>binds</em> the same array to both variables</p>
<pre><code class=language-julia >c &#61; a
c&#91;1&#93; &#61; 8
@assert a&#91;1&#93;&#61;&#61;8 # as c and a are the same thing
@assert a&#61;&#61;&#61;c  # note the triple &#96;&#61;&#96;</code></pre>
<p>Views vs copies:</p>
<p>In Julia indexing with ranges will create a new array with copies of the original&#39;s entries. Consider</p>
<pre><code class=language-julia >a &#61; rand&#40;3,4&#41;
b &#61; a&#91;1:3, 1:2&#93;
b&#91;1&#93; &#61; 99
@assert a&#91;1&#93; &#33;&#61; b&#91;1&#93;</code></pre>
<h3 id=array_exercises_variable_bindings_and_views__3 ><a href="#array_exercises_variable_bindings_and_views__3" class=header-anchor >Array exercises: variable bindings and views</a></h3>
<p>But the memory footprint will be large if we work with large arrays and take sub-arrays of them.</p>
<p>Views to the rescue</p>
<pre><code class=language-julia >a &#61; rand&#40;3,4&#41;
b &#61; @view a&#91;1:3, 1:2&#93;
b&#91;1&#93; &#61; 99</code></pre>
<p>check whether the change in <code>b</code> is reflected in <code>a</code>:</p>
<pre><code class=language-julia >@assert ...</code></pre>
<h3 id=a_small_detour_types ><a href="#a_small_detour_types" class=header-anchor >A small detour: types</a></h3>
<p>All values have types as we saw above.  Arrays store in their type what type the elements can be.</p>
<blockquote>
<p>Arrays which have concrete element-types are more performant&#33;</p>
</blockquote>
<pre><code class=language-julia >typeof&#40;&#91;1, 2&#93;&#41;, typeof&#40;&#91;1.0, 2.0&#93;&#41;</code></pre>
<p>Aside, they also store their dimension in the second parameter.</p>
<p>The type can be specified at creation</p>
<pre><code class=language-julia >String&#91;&quot;one&quot;, &quot;two&quot;&#93;</code></pre>
<p>Create an array taking <code>Int</code> with no elements.  Push <code>1</code>, <code>1.0</code> and <code>1.5</code> to it.  What happens?</p>
<pre><code class=language-julia >#</code></pre>
<p>Make an array of type <code>Any</code> &#40;which can store any value&#41;.  Push a value of type Int and one of type String to it.</p>
<pre><code class=language-julia >#</code></pre>
<p>Try to assgin 1.5 to the first element of an array of type Array&#123;Int,1&#125;</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=array_exercises__2 ><a href="#array_exercises__2" class=header-anchor >Array exercises</a></h3>
<p>Create a uninitialised Matrix of size &#40;3,3&#41; and assign it to <code>a</code>. First look up the docs of Array with <code>?Array</code></p>
<pre><code class=language-julia >#</code></pre>
<p>Test that its size is correct, see <code>size</code></p>
<pre><code class=language-julia >#</code></pre>
<h3 id=array_exercises_all_done ><a href="#array_exercises_all_done" class=header-anchor >Array exercises: ALL DONE</a></h3>
<p>The rest about Arrays you will learn-by-doing.</p>
<h2 id=control_flow_10min ><a href="#control_flow_10min" class=header-anchor >Control flow &#91;10min&#93;</a></h2>
<p>Julia provides a variety of <a href="https://docs.julialang.org/en/v1/manual/control-flow/">control flow constructs</a>, of which we look at:</p>
<ul>
<li><p><a href="https://docs.julialang.org/en/v1/manual/control-flow/#man-conditional-evaluation">Conditional Evaluation</a>: <code>if</code>-<code>elseif</code>-<code>else</code> and <code>?:</code> &#40;ternary operator&#41;.</p>

<li><p><a href="https://docs.julialang.org/en/v1/manual/control-flow/#Short-Circuit-Evaluation">Short-Circuit Evaluation</a>: logical operators <code>&amp;&amp;</code> &#40;‚Äúand‚Äù&#41; and <code>||</code> &#40;‚Äúor‚Äù&#41;, and also chained comparisons.</p>

<li><p><a href="https://docs.julialang.org/en/v1/manual/control-flow/#man-loops">Repeated Evaluation: Loops</a>: <code>while</code> and <code>for</code>.</p>

</ul>
<h3 id=conditional_evaluation ><a href="#conditional_evaluation" class=header-anchor >Conditional evaluation</a></h3>
<p>Read the first paragraph of <a href="https://docs.julialang.org/en/v1/manual/control-flow/#man-conditional-evaluation">https://docs.julialang.org/en/v1/manual/control-flow/#man-conditional-evaluation</a> &#40;up to &quot;... and no further condition expressions or blocks are evaluated.&quot;&#41;</p>
<p>Write a test which looks at the start of the string in variable <code>a</code> &#40;?startswith&#41; and sets <code>b</code> accordingly.  If the start is</p>
<ul>
<li><p>&quot;Wh&quot; then set <code>b &#61; &quot;Likely a question&quot;</code></p>

<li><p>&quot;The &quot; then set <code>b &#61; &quot;A noun&quot;</code></p>

<li><p>otherwise set <code>b &#61; &quot;no idea&quot;</code></p>

</ul>
<pre><code class=language-julia >#</code></pre>
<h3 id=conditional_evaluation_the_ternary_operator ><a href="#conditional_evaluation_the_ternary_operator" class=header-anchor >Conditional evaluation: the &quot;ternary operator&quot; <code>?</code></a></h3>
<p>Look up the docs for <code>?</code> &#40;i.e. evaluate <code>??</code>&#41;</p>
<p>Re-write using <code>?</code></p>
<pre><code class=language-julia >if a &gt; 5
    &quot;really big&quot;
else
    &quot;not so big&quot;
end</code></pre>
<pre><code class=language-julia >#</code></pre>
<h3 id=short_circuit_operators_and ><a href="#short_circuit_operators_and" class=header-anchor >Short circuit operators <code>&amp;&amp;</code> and <code>||</code></a></h3>
<p>Read <a href="https://docs.julialang.org/en/v1/manual/control-flow/#Short-Circuit-Evaluation">https://docs.julialang.org/en/v1/manual/control-flow/#Short-Circuit-Evaluation</a></p>
<p>Explain what this does</p>
<pre><code class=language-julia >a &lt; 0 &amp;&amp; error&#40;&quot;Not valid input for &#96;a&#96;&quot;&#41;</code></pre>
<p>Type your answer here &#40;to start editing, double click into this cell.  When done shift&#43;enter&#41;:</p>
<h3 id=loops_for_and_while ><a href="#loops_for_and_while" class=header-anchor >Loops: <code>for</code> and <code>while</code></a></h3>
<p><a href="https://docs.julialang.org/en/v1/manual/control-flow/#man-loops">https://docs.julialang.org/en/v1/manual/control-flow/#man-loops</a></p>
<pre><code class=language-julia >for i &#61; 1:3
    println&#40;i&#41;
end

for i in &#91;&quot;dog&quot;, &quot;cat&quot;&#93; ## &#96;in&#96; and &#96;&#61;&#96; are equivalent for writing loops
    println&#40;i&#41;
end

i &#61; 1
while i&lt;4
    println&#40;i&#41;
    i &#43;&#61; 1
end</code></pre>
<h2 id=functions_15min ><a href="#functions_15min" class=header-anchor >Functions &#91;15min&#93;</a></h2>
<p>Functions can be defined in Julia in a number of ways.  In particular there is one variant more suited to longer definitions, and one for one-liners:</p>
<pre><code class=language-julia >function f&#40;a, b&#41;
   return a * b
end
f&#40;a, b&#41; &#61; a * b</code></pre>
<p>Defining many, short functions is typical in good Julia code.</p>
<p>Read <a href="https://docs.julialang.org/en/v1/manual/functions/">https://docs.julialang.org/en/v1/manual/functions/</a> up to an including &quot;The return Keyword&quot;</p>
<h3 id=functions_exercises ><a href="#functions_exercises" class=header-anchor >Functions: exercises</a></h3>
<p>Define a function in long-form which takes two arguments. Use some if-else statements and the return keyword.</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=functions_exercises__2 ><a href="#functions_exercises__2" class=header-anchor >Functions: exercises</a></h3>
<p>Re-define the <code>map</code> function.  First look up what it does <code>?map</code>, then create a <code>mymap</code> which does the same.  Map <code>sin</code> over the vector <code>1:10</code>.</p>
<p>&#40;Note, this is a higher-order function: a function which take a function as a argument&#41;</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=functions_dot-syntax ><a href="#functions_dot-syntax" class=header-anchor >Functions: dot-syntax</a></h3>
<p>This is really similar to the <code>map</code> function, a short-hand to map/broadcast a function over values.</p>
<p>Exercise: apply the <code>sin</code> function to a vector <code>1:10</code>:</p>
<pre><code class=language-julia >#</code></pre>
<p>Broadcasting will extend row and column vectors into a matrix. Try <code>&#40;1:10&#41; .&#43; &#40;1:10&#41;&#39;</code>  &#40;Note the <code>&#39;</code>, this is the transpose operator&#41;</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=functions_dot-syntax_exercise ><a href="#functions_dot-syntax_exercise" class=header-anchor >Functions: dot-syntax exercise</a></h3>
<p>Evaluate the function <code>sin&#40;x&#41; &#43; cos&#40;y&#41;</code> for <code>x &#61; 0:0.1:pi</code> and <code>y &#61; -pi:0.1:pi</code>.  Remember to use <code>&#39;</code>.</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=functions_anonymous_functions ><a href="#functions_anonymous_functions" class=header-anchor >Functions: anonymous functions</a></h3>
<p>So far our function got a name with the definition. They can also be defined without name.</p>
<p>Read <a href="https://docs.julialang.org/en/v1/manual/functions/#man-anonymous-functions">https://docs.julialang.org/en/v1/manual/functions/#man-anonymous-functions</a></p>
<p>Map the function <code>f&#40;x,y&#41; &#61; sin&#40;x&#41; &#43; cos&#40;x&#41;</code> over <code>1:10</code> but define it as an anonymous function.</p>
<pre><code class=language-julia >#</code></pre>
<h3 id=key_feature_multiple_dispatch_functions ><a href="#key_feature_multiple_dispatch_functions" class=header-anchor >Key feature: multiple dispatch functions</a></h3>
<ul>
<li><p>Julia is not an object oriented language</p>

</ul>
<p>OO:</p>
<ul>
<li><p>methods belong to objects</p>

<li><p>method is selected based on first argument &#40;e.g. <code>self</code> in Python&#41;</p>

</ul>
<p>Multiple dispatch:</p>
<ul>
<li><p>methods are separate from objects</p>

<li><p>are selected based on all arguments</p>

<li><p>similar to overloading but method selection occurs at runtime and not compile-time &#40;see also video below&#41;</p>

</ul>
<blockquote>
<p>very natural for mathematical programming</p>
</blockquote>
<p>JuliaCon 2019 presentation on the subject by Stefan Karpinski &#40;co-creator of Julia&#41;:</p>
<p><a href="https://www.youtube.com/watch?v&#61;kc9HwsxE1OY">&quot;The Unreasonable Effectiveness of Multiple Dispatch&quot;</a></p>
<h2 id=functions_multiple_dispatch_demo ><a href="#functions_multiple_dispatch_demo" class=header-anchor >Functions: Multiple dispatch demo</a></h2>
<pre><code class=language-julia >struct Rock end
struct Paper end
struct Scissors end
### of course structs could have fields as well
# struct Rock
#     color
#     name::String
#     density::Float64
# end

# define multi-method
play&#40;::Rock, ::Paper&#41; &#61; &quot;Paper wins&quot;
play&#40;::Rock, ::Scissors&#41; &#61; &quot;Rock wins&quot;
play&#40;::Scissors, ::Paper&#41; &#61; &quot;Scissors wins&quot;
play&#40;a, b&#41; &#61; play&#40;b, a&#41; # commutative

play&#40;Scissors&#40;&#41;, Rock&#40;&#41;&#41;</code></pre>
<h3 id=multiple_dispatch_demo ><a href="#multiple_dispatch_demo" class=header-anchor >Multiple dispatch demo</a></h3>
<p>Can easily be extended later</p>
<p>with new type:</p>
<pre><code class=language-julia >struct Pond end
play&#40;::Rock, ::Pond&#41; &#61; &quot;Pond wins&quot;
play&#40;::Paper, ::Pond&#41; &#61; &quot;Paper wins&quot;
play&#40;::Scissors, ::Pond&#41; &#61; &quot;Pond wins&quot;

play&#40;Scissors&#40;&#41;, Pond&#40;&#41;&#41;</code></pre>
<p>with new function:</p>
<pre><code class=language-julia >combine&#40;::Rock, ::Paper&#41; &#61; &quot;Paperweight&quot;
combine&#40;::Paper, ::Scissors&#41; &#61; &quot;Two pieces of papers&quot;
# ...

combine&#40;Rock&#40;&#41;, Paper&#40;&#41;&#41;</code></pre>
<p><em>Multiple dispatch makes Julia packages very composable&#33;</em></p>
<p>This is a key characteristic of the Julia package ecosystem.</p>
<h2 id=modules_and_packages_5min ><a href="#modules_and_packages_5min" class=header-anchor >Modules and packages &#91;5min&#93;</a></h2>
<p>Modules can be used to structure code into larger entities, and be used to divide it into different name spaces.  We will not make much use of those, but if interested see <a href="https://docs.julialang.org/en/v1/manual/modules/">https://docs.julialang.org/en/v1/manual/modules/</a></p>
<p><strong>Packages</strong> are the way people distribute code and we&#39;ll make use of them extensively. In the first example, the Lorenz ODE, you saw</p>
<pre><code class=language-julia >using Plots</code></pre>
<p>This statement loads the package <code>Plots</code> and makes its functions and types available in the current session and use it like so:</p>
<pre><code class=language-julia >using Plots
plot&#40; &#40;1:10&#41;.^2 &#41;</code></pre>
<h3 id=packages ><a href="#packages" class=header-anchor >Packages</a></h3>
<p><strong>Note</strong> package installation does not work on the moodle-Jupyterhub.  But it will work on your local installation.</p>
<p>All public Julia packages are listed on <a href="https://juliahub.com/ui/Packages">https://juliahub.com/ui/Packages</a>.</p>
<p>You can install a package, say <code>Example.jl</code> &#40;a tiny example package&#41; by</p>
<pre><code class=language-julia >using Pkg
Pkg.add&#40;&quot;Example&quot;&#41;
using Example
hello&#40;&quot;PDE on GPU class&quot;&#41;</code></pre>
<p>In the REPL, there is also a package-mode &#40;hit <code>&#93;</code>&#41; which is for interactive use.</p>
<pre><code class=language-julia ># Install a package &#40;not a too big one, Example.jl is good that way&#41;,
# use it, query help on the package itself:</code></pre>
<h2 id=this_concludes_the_rapid_julia_tour ><a href="#this_concludes_the_rapid_julia_tour" class=header-anchor >This concludes the rapid Julia tour</a></h2>
<p>There are many more features of Julia for sure but this should get you started, and setup for the exercises.  &#40;Let us know if you feel we left something out which would have been helpful for the exercises&#41;.</p>
<p>Remember you can self-help with:</p>
<ul>
<li><p>using <code>?</code> at the notebook.  Similarly there is an <code>apropos</code> function.</p>

<li><p>the docs are your friend <a href="https://docs.julialang.org/en/v1/">https://docs.julialang.org/en/v1/</a></p>

<li><p>ask for help in our chat channel: see Moodle</p>

</ul>

<p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p>
<h1 id=exercises_-_lecture_1 ><a href="#exercises_-_lecture_1" class=header-anchor >Exercises - lecture 1</a></h1>
<h2 id=exercise_1_car_travel ><a href="#exercise_1_car_travel" class=header-anchor >Exercise 1 ‚Äî <strong>Car travel</strong></a></h2>
<p>üëâ <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture1_ex1.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >‚ö†Ô∏è Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to familiarise with:</p>
<ul>
<li><p>code structure <code># Physics, # Numerics, # Time loop, # Visualisation</code></p>

<li><p>array initialisation</p>

<li><p><code>for</code> loop &amp; <code>if</code> condition</p>

<li><p>update rule</p>

<li><p>solving ODEs</p>

</ul>
<p>A car cruises on a straight road at given speed \(\mathrm{V = 113}\) km/h for 16 hours, making a U-turn after a distance \(\mathrm{L = 200}\) km. The car speed is defined as the change of position its \(x\) per time \(t\):</p>
\[
V = \frac{\partial x}{\partial t}
\]
<p>In the above derivative, \(\partial x\) and \(\partial t\) are considered infinitesimal - a representation it is not possible to handle within a computer &#40;as it would require infinite amount of resources&#41;. However, we can discretise this differential equation in order to solve it numerically by transforming the infinitesimal quantities into discrete increments:</p>
\[
V = \frac{\partial x}{\partial t} \approx \frac{\Delta x}{\Delta t} = \frac{x_{t+\Delta t}-x_t}{\Delta t}~,
\]
<p>where \(\Delta x\) and \(\Delta t\) are discrete quantities. This equation can be re-organised to return an explicit solution of the position \(x\) at time \(t+\Delta t\):</p>
\[
x_{t+\Delta t} = x_{t} + V \Delta t~.
\]
<ol>
<li><p>Based on this equation, your task is to setup a numerical model to predict the position of the car as function of time. In order not to start from scratch this time, you can complete the code draft below, filling in the relevant quantities in following order:</p>

</ol>
<pre><code class=language-julia >using Plots

@views function car_travel_1D&#40;&#41;
    # Physical parameters

    # Numerical parameters

    # Array initialisation

    # Time loop

    # Visualisation

    return
end

car_travel_1D&#40;&#41;</code></pre>
<ol start=2 >
<li><p>Implement a condition to allow you doing U-turns whenever you reach the position \(x=0\) or \(x=200\).</p>

</ol>
<p>The sample code you can use to get started looks like:</p>
<pre><code class=language-julia >using Plots

@views function car_travel_1D&#40;&#41;
    # Physical parameters
    V     &#61;         # speed, km/h
    L     &#61;         # length of segment, km
    ttot  &#61;         # total time, h
    # Numerical parameters
    dt    &#61; 0.1            # time step, h
    nt    &#61; Int&#40;cld&#40;ttot, dt&#41;&#41;  # number of time steps
    # Array initialisation
    T     &#61;
    X     &#61;
    # Time loop
    for it &#61; 2:nt
        T&#91;it&#93; &#61; T&#91;it-1&#93; &#43; dt
        X&#91;it&#93; &#61;   # move the car
        if X&#91;it&#93; &gt; L
                # if beyond L, go back &#40;left&#41;
        elseif X&#91;it&#93; &lt; 0
                # if beyond 0, go back &#40;right&#41;
        end
    end
    # Visualisation
    display&#40;scatter&#40;T, X, markersize&#61;5,
                    xlabel&#61;&quot;time, hrs&quot;, ylabel&#61;&quot;distance, km&quot;,
                    framestyle&#61;:box, legend&#61;:none&#41;&#41;
    return
end

car_travel_1D&#40;&#41;</code></pre>
<p>Note that you can extend the first code &#40;from step 1&#41; to include the U-turns and use your final code to reply to the question.</p>
<h3 id=question_1 ><a href="#question_1" class=header-anchor >Question 1</a></h3>
<p>Once the code is running, test various time step increments <code>0.1 &lt; dt &lt; 1.0</code> and briefly comment on your findings.</p>

<p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_2_car_travel_in_2_dimensions ><a href="#exercise_2_car_travel_in_2_dimensions" class=header-anchor >Exercise 2 ‚Äî <strong>Car travel in 2 dimensions</strong></a></h2>
<p>üëâ <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture1_ex2.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >‚ö†Ô∏è Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to familiarise with:</p>
<ul>
<li><p>code structure <code># Physics, # Numerics, # Time loop, # Visualisation</code></p>

<li><p>array initialisation</p>

<li><p>2 spatial dimensions</p>

<li><p>solving ODEs</p>

</ul>
<p>Based on the experience you acquired solving the <a href="#exercise_1_-_car_travel">Exercise 1</a> we can now consider a car moving within a 2-dimensional space. The car still travels at speed \(V=113\) km/h, but now in North-East or North-West direction. The West-East and South-North directions being the \(x\) and \(y\) axis, respectively. The car&#39;s displacement in the West-East directions is limited to \(L=200\) km. The speed in the North direction remains constant.</p>
<p>Starting from the 1D code done in <a href="#exercise_1_-_car_travel">Exercise 1</a>, work towards adding the second spatial dimension. Now, the car&#39;s position \((x,y)\) as function of time \(t\) has two components.</p>
<div class=note ><div class=title >üí° Note</div>
<div class=messg ><ul>
<li><p>Split velocity magnitude \(V\) into \(x\) and \(y\) component</p>

<li><p>Use <code>sind&#40;&#41;</code> or <code>cosd&#40;&#41;</code> functions if passing the angle in <em>deg</em> instead of <em>rad</em></p>

<li><p>Use two vectors or an array to store the car&#39;s coordinates</p>

<li><p>Define the y-axis extend in the plot <code>ylims&#61;&#40;0, ttot*Vy&#41;</code></p>

</ul></div></div>
<h3 id=question_1__2 ><a href="#question_1__2" class=header-anchor >Question 1</a></h3>
<p>Visualise graphically the trajectory of the travelling car for a simulation with time step parameter defined as <code>dt &#61; 0.1</code>.</p>

<p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_3_volcanic_bomb ><a href="#exercise_3_volcanic_bomb" class=header-anchor >Exercise 3 ‚Äî <strong>Volcanic bomb</strong></a></h2>
<p>üëâ <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture1_ex3.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >‚ö†Ô∏è Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to consolidate:</p>
<ul>
<li><p>code structure <code># Physics, # Numerics, # Time loop, # Visualisation</code></p>

<li><p>array initialisation</p>

<li><p>update rule</p>

<li><p><code>if</code> condition</p>

</ul>
<p>You will now simulate the trajectory of a <a href="https://en.wikipedia.org/wiki/Volcanic_bomb">volcanic bomb</a> that got ejected during a volcanic eruption. The ejection speed is given by the horizontal and vertical velocity components</p>
\[
V_x = \frac{\partial x}{\partial t}\\[10pt]
V_y = \frac{\partial y}{\partial t}
\]
<p>Once ejected, the volcanic bomb is subject to gravity acceleration \(g\). Air friction will be neglected. Acceleration being defined as the change of velocity over time, we obtain the following update rule:</p>
\[
\frac{\partial V_y}{\partial t}=-g
\]
<p>These equations define a mathematical model describing the kinematics of the volcanic bomb. You may remember from your studies how to solve those equation analytically; however we&#39;ll here focus on a numerical solution using a similar approach as for the previous exercises. The \(x\) and \(y\) location of the bomb as function of time can be obtained based on updating previous values using the definition of velocity:</p>
\[
x_{t+\Delta t} = x_{t} + V_x    \Delta t~,\\[5pt]
y_{t+\Delta t} = y_{t} + V_y(t) \Delta t~.
\]
<p>And because of gravity acceleration, the \(V_y\) velocity evolution can be obtained according to</p>
\[
V_{y,t+\Delta t} = V_{y,t} - g \Delta t~.
\]
<p>The 3 equations above represent the discretised form of the 3 first equations and should be used to solve the problem numerically. The initial position of the volcanic bomb \((x_0, y_0)=(0,480)\) m. The magnitude of the ejection speed is of 120 m/s and the angle \(\alpha = 60¬∞\). The simulation stops when the volcanic bomb touches the ground &#40;\(y=0\)&#41;.</p>
<div class=note ><div class=title >üí° Note</div>
<div class=messg ><ul>
<li><p>Modify the code from exercise 2 to, in addition, account for the change of <code>Vy</code> with time</p>

<li><p>Use e.g. a <code>break</code> statement to exit the loop once the bomb hits the ground</p>

</ul></div></div>
<h3 id=question_1__3 ><a href="#question_1__3" class=header-anchor >Question 1</a></h3>
<p>Report the height of the volcanic bomb at position \(x=900\) m away from origin.</p>

<p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_4_optional_orbital_around_a_centre_of_mass ><a href="#exercise_4_optional_orbital_around_a_centre_of_mass" class=header-anchor >Exercise 4 <em>&#40;optional&#41;</em> ‚Äî <strong>Orbital around a centre of mass</strong></a></h2>
<p>üëâ <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture1_ex4.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >‚ö†Ô∏è Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to consolidate:</p>
<ul>
<li><p>code structure <code># Physics, # Numerics, # Time loop, # Visualisation</code></p>

<li><p>physics implementation</p>

<li><p>update rule</p>

</ul>
<p>The goal of this exercise is to reproduce an orbital around a fixed centre of mass, which is also the origin of the coordinate system &#40;e.g. Earth - Sun&#41;. To solve this problem, you will have to know about the definition of velocity, Newton&#39;s second law and universal gravitation&#39;s law:</p>
\[
\frac{dr_i}{dt}=v_i \\[10pt]
\frac{dv_i}{dt}=\frac{F_i}{m} \\[10pt]
F_i = -G\frac{mM}{|r_i|^2}\frac{r_i}{|r_i|}~,
\]
<p>where \(r_i\) is the position vector, \(v_i\) the velocity vector, \(F_i\) the force vector, \(G\) is the gravitational constant, \(m\) is the mass of the orbiting object, \(M\) is the mass of the centre of mass and \(|r_i|\) is the norm of the position vector.</p>
<hr />
<p>The sample code you can use to get started looks like:</p>
<pre><code class=language-julia >using Plots

@views function orbital&#40;&#41;
    # Physics
    G    &#61; 1.0
    # TODO - add physics input
    tt   &#61; 6.0
    # Numerics
    dt   &#61; 0.05
    # Initial conditions
    xpos &#61; ??
    ypos &#61; ??
    # TODO - add further initial conditions
    # Time loop
    for it &#61; 1:nt
        # TODO - Add physics equations
        # Visualisation
        display&#40;scatter&#33;&#40;&#91;xpos&#93;, &#91;ypos&#93;, title&#61;&quot;&#36;it&quot;,
                         aspect_ratio&#61;1, markersize&#61;5, markercolor&#61;:blue, framestyle&#61;:box,
                         legend&#61;:none, xlims&#61;&#40;-1.1, 1.1&#41;, ylims&#61;&#40;-1.1, 1.1&#41;&#41;&#41;
    end
    return
end

orbital&#40;&#41;</code></pre>
<h3 id=question_1__4 ><a href="#question_1__4" class=header-anchor >Question 1</a></h3>
<p>For a safe start, set all physical parameters \((G, m, M)\) equal to 1, and use as initial conditions \(x_0=0\) and \(y_0=1\), and \(v_x=1\) and \(v_y=0\). You should obtain a circular orbital.</p>
<p>Report the last \((x,y)\) position of the Earth for a total time of <code>tt&#61;6.0</code> with a time step <code>dt&#61;0.05</code>.</p>
<div class=note ><div class=title >üí° Note</div>
<div class=messg ><ul>
<li><p>\(r_i=[x,y]\)</p>

<li><p>\(|r_i|=\sqrt{x^2 + y^2}\)</p>

<li><p>\(r_i/|r_i|\) stands for the unity vector &#40;of length 1&#41; pointing from \(m\) towards \(M\)</p>

</ul></div></div>
<h3 id=question_2 ><a href="#question_2" class=header-anchor >Question 2</a></h3>
<p>Head to e.g. Wikipedia and look up for approximate of real values and asses whether the Earth indeed needs ~365 days to achieve one rotation around the Sun.</p>

<p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_5_optional_many_volcanic_bombs ><a href="#exercise_5_optional_many_volcanic_bombs" class=header-anchor >Exercise 5 <em>&#40;optional&#41;</em> ‚Äî <strong>Many volcanic bombs</strong></a></h2>
<p>üëâ <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture1_ex5.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >‚ö†Ô∏è Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to consolidate:</p>
<ul>
<li><p>vectorisation and element-wise operations using <code>.</code></p>

<li><p>random numbers</p>

<li><p>array initialisation</p>

<li><p>conditional statement</p>

</ul>
<p>The goal is to extend the volcanic bomb calculator &#40;exercise 3&#41; to handle <code>nb</code> bombs.</p>
<p>To do so, start from the script you wrote to predict the trajectory of a single volcanic bomb and extend it to handle <code>nb</code> bombs.</p>
<p>Declare a new variable for the number of volcanic bombs</p>
<pre><code class=language-julia >nb &#61; 5 # number of volcanic bombs</code></pre>
<p>Then, replace the vertical angle of ejection Œ± to randomly vary between 60¬∞ and 120¬∞ with respect to the horizon for each bomb. Keep the magnitude of the ejection velocity as before, i.e. \(V=120\) m/s.</p>
<div class=note ><div class=title >üí° Note</div>
<div class=messg >Use the <code>randn&#40;&#41;</code> function to generate random numbers normally distributed.</div></div>
<p>All bombs have the same initial location \((x=0, y=480)\) as before.</p>
<p>Implement the necessary modifications in the time loop in order to update the position of all volcanic bombs correctly.</p>
<p>Ensure the bombs stop their motion once they hit the ground &#40;at position \(y=0\)&#41;.</p>
<h3 id=question_1__5 ><a href="#question_1__5" class=header-anchor >Question 1</a></h3>
<p>Report the total time it takes for the last, out of 5, volcanic bombs to hit the ground and provide a figure that visualise the bombs&#39; overall trajectories.</p>
<h3 id=question_2__2 ><a href="#question_2__2" class=header-anchor >Question 2</a></h3>
<p>Repeat the exercise 1 but vectorise all your code, i.e. make use of broadcasting capabilities in Julia &#40;using <code>.</code> operator&#41; to only have a single loop for advancing in time.</p>

<p><a href="#content">‚§¥ <em><strong>back to Content</strong></em></a></p>
<div class=page-foot >
  <div class=copyright >
    <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/"><b>Edit this page on <img class=github-logo  src="https://unpkg.com/ionicons@5.1.2/dist/svg/logo-github.svg"></b></a><br>
    Last modified: September 17, 2024. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>  
    
        <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

    
    
        <script src="/libs/highlight/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: '    '});</script>