<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <script src="/libs/lunr/lunr.min.js"></script> <script src="/libs/lunr/lunr_index.js"></script> <script src="/libs/lunr/lunrclient.min.js"></script> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <link rel=stylesheet  href="/css/custom.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/assets/favicon.png"> <title>Lecture 2</title> <style> .content {max-width: 50rem} </style> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <img src="/assets/vaw_logo.png" style="width: 180px; height: auto; display: inline"> <div style="font-weight: margin-bottom: 0.5em"><a href="/"> Fall 2022</a> <span style="opacity: 0.7;">| <a href="http://www.vvz.ethz.ch/Vorlesungsverzeichnis/lerneinheit.view?semkez=2022W&ansicht=KATALOGDATEN&lerneinheitId=162403&lang=en"> ETHZ 101-0250-00</a></span></div> <br> <h1><a href="/">Solving partial differential equations in parallel on GPUs</a></h1> <div style="line-height:18px; font-size: 15px; opacity: 0.85">by &nbsp; <a href="https://vaw.ethz.ch/en/people/person-detail.MjcwOTYw.TGlzdC8xOTYxLDE1MTczNjI1ODA=.html">Ludovic Räss</a>, &nbsp; <a href="https://vaw.ethz.ch/en/personen/person-detail.html?persid=124402">Mauro Werder</a>, &nbsp; <a href="https://www.cscs.ch/about/staff/">Samuel Omlin</a> & <br> <a href="https://vaw.ethz.ch/en/people/person-detail.MzAwMjIy.TGlzdC8xOTYxLDE1MTczNjI1ODA=.html">Ivan Utkin</a> </div> </div> <br> <style> </style> <nav class=sidebar-nav  style="opacity: 0.9; margin-bottom: 1.2cm;"> <a class="sidebar-nav-item " href="/"><b>Welcome</b></a> <a class="sidebar-nav-item " href="/logistics/">Logistics</a> <a class="sidebar-nav-item " href="/homework/">Homework</a> <a class="sidebar-nav-item " href="/software_install/">Software install</a> <a class="sidebar-nav-item " href="/extras/">Extras</a> <br> <div class=course-section >Part 1 - Introduction</div> <a class="sidebar-nav-item " href="/lecture1/">Lecture 1 - Why Julia GPU</a> <a class="sidebar-nav-item active" href="/lecture2/">Lecture 2 - PDEs & physical processes</a> <a class="sidebar-nav-item " href="/lecture3/">Lecture 3 - Solving elliptic PDEs</a> <div class=course-section >Part 2 - Solving PDEs on GPUs</div> <a class="sidebar-nav-item " href="/lecture4/">Lecture 4 - Porous convection</a> <a class="sidebar-nav-item " href="/lecture5/">Lecture 5 - Parallel computing</a> <a class="sidebar-nav-item " href="/lecture6/">Lecture 6 - GPU computing & perf</a> <div class=course-section >Part 3 - Multi-GPU computing (projects)</div> <a class="sidebar-nav-item " href="/lecture7/">Lecture 7 - XPU computing</a> <a class="sidebar-nav-item " href="/lecture8/">Lecture 8 - Julia MPI & multi-XPU</a> <a class="sidebar-nav-item " href="/lecture9/">Lecture 9 - Advanced optimisations</a> <div class=course-section >Final Projects</div> <a class="sidebar-nav-item " href="/lecture10/">Lecture 10 - Final projects</a> </nav> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text > <input type=submit  value=Search  formaction="/search/index.html"> </form> <br> <br> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id=lecture_2 ><a href="#lecture_2" class=header-anchor >Lecture 2</a></h1> <blockquote> <p><strong>Agenda</strong><br />📚 PDEs and physical processes – diffusion, wave propagation, advection<br />💻 Get started on GitHub<br />🚧 Exercises:</p> <ul> <li><p>Basic code structure &amp; vectorisation</p> <li><p>Combine physical processes</p> <li><p>First steps on Git</p> </ul> </blockquote> <p><hr /> </p> <p><a id=content  class=anchor ></a> <strong>Content</strong></p> <div class=franklin-toc ><ol><li><a href="#lecture_2">Lecture 2</a><li><a href="#pdes_and_physical_processes_-_diffusion_wave_propagation_advection">PDEs and physical processes - diffusion, wave propagation, advection</a><ol><li><a href="#parabolic_pdes_-_diffusion">Parabolic PDEs - diffusion</a><li><a href="#hyperbolic_pdes_-_acoustic_wave_propagation">Hyperbolic PDEs - acoustic wave propagation</a><li><a href="#the_wave_equation">The wave equation</a><li><a href="#compare_the_equationss">Compare the equationss</a><li><a href="#first-order_pdes_-_advection">First-order PDEs - advection</a><li><a href="#nonlinear_equations">Nonlinear equations</a><li><a href="#first_step_towards_solving_the_elliptic_problem">First step towards solving the elliptic problem</a><li><a href="#solution_to_the_elliptic_pde">Solution to the elliptic PDE...</a><li><a href="#wrapping-up">Wrapping-up</a></ol><li><a href="#a_brief_intro_to_git">A brief intro to Git</a><ol><li><a href="#previous_experience">Previous experience</a><li><a href="#a_brief_git_demo_session">A brief git demo session</a><li><a href="#further_reading">Further reading</a><li><a href="#other_tools_for_git">Other tools for git</a><li><a href="#getting_started_on_github_similar_on_gitlab_or_elsewhere">Getting started on GitHub &#40;similar on GitLab, or elsewhere&#41;</a><li><a href="#github_setup">GitHub setup</a><li><a href="#lets_get_our_repo_onto_github">Let&#39;s get our repo onto GitHub</a><li><a href="#work_with_other_peoples_code_fork">Work with other peoples code: fork</a><li><a href="#git_questions">Git: questions?</a></ol><li><a href="#exercises_-_lecture_2">Exercises - lecture 2</a><ol><li><a href="#exercise_1_-_advection-diffusion">Exercise 1 - <strong>Advection-Diffusion</strong></a><li><a href="#exercise_2_-_reaction-diffusion">Exercise 2 - <strong>Reaction-Diffusion</strong></a><li><a href="#exercise_3_-_nonlinear_problems">Exercise 3 - <strong>Nonlinear problems</strong></a><li><a href="#exercise_4_-_julia_install_and_git_repo">Exercise 4 - <strong>Julia install and Git repo</strong></a></ol></ol></div> <p><a href="#exercises_-_lecture_2"><em>👉 get started with exercises</em></a></p> <hr /> <h1 id=pdes_and_physical_processes_-_diffusion_wave_propagation_advection ><a href="#pdes_and_physical_processes_-_diffusion_wave_propagation_advection" class=header-anchor >PDEs and physical processes - diffusion, wave propagation, advection</a></h1> <h3 id=the_goal_of_this_lecture_2_is_to_familiarise_or_refresh_with ><a href="#the_goal_of_this_lecture_2_is_to_familiarise_or_refresh_with" class=header-anchor >The goal of this lecture 2 is to familiarise &#40;or refresh&#41; with</a></h3> <ul> <li><p>Partial differential equations - PDEs &#40;e.g. diffusion and advection equations&#41;</p> <li><p>Finite-difference discretisation</p> <li><p>Explicit solutions</p> <li><p>Nonlinear processes</p> <li><p>Multi-process &#40;physics&#41; coupling</p> </ul> <p>A <strong>partial differential equation &#40;PDE&#41;</strong> is an equation which imposes relations between the various partial derivatives of a multivariable function. <a href="https://en.wikipedia.org/wiki/Partial_differential_equation"><em>Wikipedia</em></a></p> <div class=note ><div class=title >💡 Note</div> <div class=messg ><p><em><strong>Classification of second-order PDEs:</strong></em></p> <ul> <li><p><strong>Parabolic:</strong><br /><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∂</mi><mi>u</mi><mi mathvariant=normal >/</mi><mi mathvariant=normal >∂</mi><mi>t</mi><mo>−</mo><mi>α</mi><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>u</mi><mo>−</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">∂u/∂t - α ∇^2 u - b = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">u</span><span class=mord >/</span><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> &#40;e.g. transient heat diffusion&#41;</p> <li><p><strong>Hyperbolic:</strong><br /><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>u</mi><mi mathvariant=normal >/</mi><mi mathvariant=normal >∂</mi><msup><mi>t</mi><mn>2</mn></msup><mo>−</mo><msup><mi>c</mi><mn>2</mn></msup><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>u</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">∂^2u/∂t^2 - c^2 ∇^2 u = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class=mord >/</span><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.8141079999999999em;vertical-align:0em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> &#40;e.g. acoustic wave equation&#41;</p> <li><p><strong>Elliptic:</strong><br /><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>u</mi><mo>−</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">∇^2 u - b = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.897438em;vertical-align:-0.08333em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> &#40;e.g. steady state diffusion, Laplacian&#41;</p> </ul></div></div> <h2 id=parabolic_pdes_-_diffusion ><a href="#parabolic_pdes_-_diffusion" class=header-anchor >Parabolic PDEs - diffusion</a></h2> <center> <video width="80%" autoplay loop controls src="../assets/literate_figures/diffusion_1D.mp4"/> </center> <p>The <a href="https://en.wikipedia.org/wiki/Diffusion_equation">diffusion equation</a> was introduced by Fourier in 1822 to understand heat distribution &#40;<a href="https://en.wikipedia.org/wiki/Heat_equation">heat equation</a>&#41; in various materials.</p> <p>Diffusive processes were also employed by Fick in 1855 with application to chemical and particle diffusion &#40;<a href="https://en.wikipedia.org/wiki/Fick&#37;27s_laws_of_diffusion">Fick&#39;s law</a>&#41;.</p> <p>The diffusion equation is often reported as a second order parabolic PDE, here for a multivariable function <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo stretchy=false >(</mo><mi>x</mi><mo separator=true >,</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">C(x,t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mopen >(</span><span class="mord mathnormal">x</span><span class=mpunct >,</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> showing derivatives in both temporal <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">∂t</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span></span> and spatial <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">∂x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span></span> derivatives &#40;here for the 1D case&#41;</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mi>D</mi><mfrac><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂C}{∂t} = D\frac{∂^2 C}{∂ x^2}~, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> is the diffusion coefficient.</p> <p>A more general description combines a diffusive flux:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>q</mi><mo>=</mo><mo>−</mo><mi>D</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> q = -D\frac{∂C}{∂x}~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord >−</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span> <p>and a conservation or flux balance equations:</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>q</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \frac{∂C}{∂t} = -\frac{∂q}{∂x}~. </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.0574399999999997em;vertical-align:-0.686em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.3714399999999998em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mord >.</span></span></span></span></span> <p>To discretise the diffusion equation, we will keep the explicit forward Euler method as temporal discretisation and use <a href="https://en.wikipedia.org/wiki/Finite_difference">finite-differences</a> for the spatial discretisation.</p> <p>Finite-differences discretisation on regular staggered grid allows for concise and performance oriented algorithms, because only neighbouring cell access is needed to evaluate gradient and data alignment is natively pretty optimal.</p> <p>A long story short, we will approximate the gradient of concentration <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> over a distance <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">∂x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span></span>, a first derivative <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{∂C}{∂x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>, we will perform following discrete operation</p> <span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msub><mi>C</mi><mrow><mi>x</mi><mo>+</mo><mi>d</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>C</mi><mi>x</mi></msub></mrow><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{C_{x+dx} - C_{x}}{dx}~, </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.04633em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.36033em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span> <p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">dx</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span> is the discrete size of the cell.</p> <p>The same reasoning also applies to the flux balance equation.</p> <p>We can use Julia&#39;s <code>diff&#40;&#41;</code> operator to apply the <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>x</mi><mo>+</mo><mi>d</mi><mi>x</mi></mrow></msub><mo>−</mo><msub><mi>C</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex"> C_{x+dx} - C_{x} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.891661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>,</p> <pre><code class="julia hljs">C[ix+<span class=hljs-number >1</span>] - C[ix]</code></pre>
<p>in a vectorised fashion to our entire <code>C</code> vector as</p>
<pre><code class="julia hljs">diff(C)</code></pre>
<p>So, we are ready to solve the 1D diffusion equation.</p>
<p>We introduce the physical parameters that are relevant for the considered problem, i.e., the domain length <code>lx</code> and the diffusion coefficient <code>dc</code>:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># physics</span>
lx   = <span class=hljs-number >10.0</span>
dc   = <span class=hljs-number >1.0</span></code></pre>
<p>Then we declare numerical parameters: the number of grid cells used to discretize the computational domain <code>nx</code>, and the frequency of updating the visualisation <code>nvis</code>:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># numerics</span>
nx   = <span class=hljs-number >200</span>
nvis = <span class=hljs-number >5</span></code></pre>
<p>In the <code># array initialisation</code> section, we need to initialise one array to store the concentration field <code>C</code>, and the diffusive flux in the x direction <code>qx</code>:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># array initialisation</span>
C    = @. sin(<span class=hljs-number >10</span><span class=hljs-literal >π</span>*xc/lx); C_i = copy(C)
qx   = zeros(<span class=hljs-built_in >Float64</span>, nx) <span class=hljs-comment ># won&#x27;t work</span></code></pre>
<p>Wait... why it wouldn&#39;t work?</p>
<p>👉 Your turn. Let&#39;s implement our first diffusion solver trying to think about how to solve the staggering issue.</p>
<p>The initialisation steps of the diffusion code should contain</p>
<pre><code class="julia hljs"><span class=hljs-comment ># physics</span>
lx   = <span class=hljs-number >20.0</span>
dc   = <span class=hljs-number >1.0</span>
<span class=hljs-comment ># numerics</span>
nx   = <span class=hljs-number >200</span>
nvis = <span class=hljs-number >5</span>
<span class=hljs-comment ># derived numerics</span>
dx   = lx/nx
dt   = dx^<span class=hljs-number >2</span>/dc/<span class=hljs-number >2</span>
nt   = nx^<span class=hljs-number >2</span> ÷ <span class=hljs-number >100</span>
xc   = <span class=hljs-built_in >LinRange</span>(dx/<span class=hljs-number >2</span>,lx-dx/<span class=hljs-number >2</span>,nx)
<span class=hljs-comment ># array initialisation</span>
C    = @. sin(<span class=hljs-number >10</span><span class=hljs-literal >π</span>*xc/lx); C_i = copy(C)
qx   = zeros(<span class=hljs-built_in >Float64</span>, nx) <span class=hljs-comment ># won&#x27;t work</span></code></pre>
<p>Followed by the 3 physics computations &#40;lines&#41; in the time loop</p>
<pre><code class="julia hljs"><span class=hljs-comment ># time loop</span>
<span class=hljs-keyword >for</span> it = <span class=hljs-number >1</span>:nt
    <span class=hljs-comment >#qx          .= # add solution</span>
    <span class=hljs-comment >#C[2:end-1] .-= # add solution</span>
    <span class=hljs-comment ># visualisation</span>
<span class=hljs-keyword >end</span></code></pre>
<p>One can examine the size of the various vectors ...</p>
<pre><code class="julia hljs"><span class=hljs-comment ># check sizes and staggering</span>
<span class=hljs-meta >@show</span> size(qx)
<span class=hljs-meta >@show</span> size(C)
<span class=hljs-meta >@show</span> size(C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>])</code></pre>
<p>... and visualise it</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Plots
plot( xc               , C , label=<span class=hljs-string >&quot;Concentration&quot;</span>        , linewidth=:<span class=hljs-number >1.0</span>, markershape=:circle, markersize=<span class=hljs-number >5</span>, framestyle=:box)
plot!(xc[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>].+dx/<span class=hljs-number >2</span>, qx, label=<span class=hljs-string >&quot;flux of concentration&quot;</span>, linewidth=:<span class=hljs-number >1.0</span>, markershape=:circle, markersize=<span class=hljs-number >5</span>, framestyle=:box)</code></pre>
<p>Note: plotting and visualisation is slow. A convenient workaround is to only visualise or render the figure every <code>nvis</code> iteration within the time loop</p>
<pre><code class="julia hljs"><span class=hljs-meta >@gif</span> <span class=hljs-keyword >for</span> it = <span class=hljs-number >1</span>:nt
    <span class=hljs-comment ># plot(...)</span>
<span class=hljs-keyword >end</span> every nvis</code></pre>
<h2 id=hyperbolic_pdes_-_acoustic_wave_propagation ><a href="#hyperbolic_pdes_-_acoustic_wave_propagation" class=header-anchor >Hyperbolic PDEs - acoustic wave propagation</a></h2>
<h2 id=the_wave_equation ><a href="#the_wave_equation" class=header-anchor >The wave equation</a></h2>
<p>The wave equation is a second-order partial differential equation.</p>
<blockquote>
<p>The <a href="https://en.wikipedia.org/wiki/Wave_equation">wave equation</a> is a second-order linear partial differential equation for the description of waves—as they occur in classical physics—such as mechanical waves &#40;e.g. water waves, sound waves and seismic waves&#41; or light waves. <a href="https://en.wikipedia.org/wiki/Wave_equation"><em>Wikipedia</em></a></p>
</blockquote>
<p>The hyperbolic equation reads</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>P</mi><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂^2P}{∂t^2} = c^2 ∇^2 P~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<p>where</p>
<ul>
<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span> is pressure &#40;or, displacement, or another scalar quantity...&#41;</p>

<li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span> a real constant &#40;speed of sound, stiffness, ...&#41;</p>

</ul>
<p>The wave equation can be elegantly derived, e.g., from <a href="https://en.wikipedia.org/wiki/Wave_equation#From_Hooke&#39;s_law">Hooke&#39;s law</a> and second law of Newton considering masses interconnected with springs.</p>
<p><img src="../assets/literate_figures/hooke.png" alt=hook  /></p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><msub><mi>F</mi><mrow><mi mathvariant=normal >N</mi><mi mathvariant=normal >e</mi><mi mathvariant=normal >w</mi><mi mathvariant=normal >t</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >n</mi></mrow></msub><mtext>  </mtext><mo>=</mo><mtext>  </mtext><msub><mi>F</mi><mrow><mi mathvariant=normal >H</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >o</mi><mi mathvariant=normal >k</mi></mrow></msub><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> F_\mathrm{Newton}~~=~~F_\mathrm{Hook}~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">N</span><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight" style="margin-right:0.01389em;">w</span><span class="mord mathrm mtight">t</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">n</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">H</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">o</span><span class="mord mathrm mtight">k</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>m</mi><mo>⋅</mo><mi>a</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mi>k</mi><msub><mi>x</mi><mo>+</mo></msub><mo>−</mo><mi>k</mi><msub><mi>x</mi><mo>−</mo></msub><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> m⋅a(t)~~=~~k x_+ - k x_-~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class="mspace nobreak"> </span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.902771em;vertical-align:-0.208331em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> is the mass, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> de spring stiffness, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">x_+</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mo>−</mo></msub></mrow><annotation encoding="application/x-tex">x_-</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> the oscillations of the masses &#40;small distances&#41;. The acceleration <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo stretchy=false >(</mo><mi>t</mi><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">a(t)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class=mopen >(</span><span class="mord mathnormal">t</span><span class=mclose >)</span></span></span></span> can be substituted by the second derivative of displacement <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span> as function of time <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>u</mi><mi mathvariant=normal >/</mi><mi mathvariant=normal >∂</mi><msup><mi>t</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">∂^2u/∂t^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class=mord >/</span><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>, while balancing <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mo>+</mo></msub><mo>−</mo><msub><mi>x</mi><mo>−</mo></msub></mrow><annotation encoding="application/x-tex">x_+ - x_-</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.791661em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.638891em;vertical-align:-0.208331em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> and taking the limit leads to <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>u</mi><mi mathvariant=normal >/</mi><mi mathvariant=normal >∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">∂^2u/∂x^2</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal">u</span><span class=mord >/</span><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>.</p>
<h3 id=back_to_the_wave_equation ><a href="#back_to_the_wave_equation" class=header-anchor >Back to the wave equation</a></h3>
<p>The objective is to implement the wave equation in 1D &#40;spatial discretisation&#41; using an explicit time integration &#40;forward Euler&#41; as for the diffusion physics.</p>
<p>Our first task will be to modify the diffusion equation...</p>
<p>... in order to obtain and implement the acoustic wave equation:</p>

<center>
  <video width="80%" autoplay loop controls src="../assets/literate_figures/acoustic_1D.mp4"/>
</center>

<h3 id=from_diffusion_to_acoustic_wave_propagation ><a href="#from_diffusion_to_acoustic_wave_propagation" class=header-anchor >From diffusion to acoustic wave propagation</a></h3>
<p>We won&#39;t implement first the hyperbolic equation as introduced, but rather start from a first order system, similar to the one that we used to implement the diffusion equation.</p>
<p>To this end, we can rewrite the second order wave equation</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><msup><mi mathvariant=normal >∇</mi><mn>2</mn></msup><mi>P</mi><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂^2 P}{∂t^2} = c^2 ∇^2 P~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">t</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">c</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<p>as two first order equations</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>V</mi><mi>x</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><mtext> </mtext><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂V_x}{∂t} = -\frac{1}{ρ}~\frac{∂P}{∂x}~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal">ρ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>β</mi></mfrac><mtext> </mtext><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>V</mi><mi>x</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \frac{∂P}{∂t}  = -\frac{1}{\beta}~\frac{∂V_x}{∂x}~.</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.25188em;vertical-align:-0.8804400000000001em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mord >.</span></span></span></span></span>
<p>Let&#39;s get started.</p>
<p>👉 <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/">Download the <code>diffusion_1D.jl</code> script</a> to get you started</p>
<p>We can start modifying the diffusion code&#39;s, adding <code>ρ</code> and <code>β</code> in <code># physics</code> section, and taking a Gaussian &#40;centred in <code>lx/2</code>&#41; as initial condition for the pressure <code>Pr</code></p>
<pre><code class="julia hljs"><span class=hljs-comment ># physics</span>
lx   = <span class=hljs-number >20.0</span>
ρ,β  = <span class=hljs-number >1.0</span>,<span class=hljs-number >1.0</span>

<span class=hljs-comment ># array initialisation</span>
<span class=hljs-comment >#Pr  =  exp.(...)</span></code></pre>
<p>Note that the time step needs a new definition: <code>dt &#61; dx/sqrt&#40;1/ρ/β&#41;</code></p>
<p>Then, the diffusion physics:</p>
<pre><code class="julia hljs">qx          .= .-dc.*diff(C )./dx
C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .-=   dt.*diff(qx)./dx</code></pre>
<p>Should be modified to account for pressure <code>Pr</code> instead of concentration <code>C</code>, the velocity update &#40;<code>Vx</code>&#41; added, and the coefficients modified:</p>
<pre><code class="julia hljs">Vx          .-= ...
Pr[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .-= ...</code></pre>
<p>Comparing diffusive and wave physics, we can summarise following:</p>
<h2 id=compare_the_equationss ><a href="#compare_the_equationss" class=header-anchor >Compare the equationss</a></h2>
<table><tr><th align=center >Diffusion<th align=center >Wave propagation<tr><td align=center ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mo>−</mo><mi>D</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> q = -D\frac{\partial C}{\partial x} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord >−</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><td align=center ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>U</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>ρ</mi></mfrac><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \frac{\partial U}{\partial t} = -\frac{1}{\rho}\frac{\partial P}{\partial x} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.3612159999999998em;vertical-align:-0.481108em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ρ</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><tr><td align=center ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>q</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \frac{\partial C}{\partial t} = -\frac{\partial q}{\partial x} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.277216em;vertical-align:-0.345em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><td align=center ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>β</mi></mfrac><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>U</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex"> \frac{\partial P}{\partial t} = -\frac{1}{\beta}\frac{\partial U}{\partial x} </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.3612159999999998em;vertical-align:-0.481108em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></table>
<h2 id=first-order_pdes_-_advection ><a href="#first-order_pdes_-_advection" class=header-anchor >First-order PDEs - advection</a></h2>

<center>
  <video width="80%" autoplay loop controls src="../assets/literate_figures/advection_1D.mp4"/>
</center>

<blockquote>
<p>Advection is a partial differential equation that governs the motion of a conserved scalar field as it is advected by a known velocity vector field. <a href="https://en.wikipedia.org/wiki/Advection"><em>Wikipedia</em></a></p>
</blockquote>
<p>We will here briefly discuss advection of a quantity <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span> by a constant velocity <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">v_x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> in the one-dimensional x-direction.</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mfrac><mrow><mi mathvariant=normal >∂</mi><mo stretchy=false >(</mo><msub><mi>v</mi><mi>x</mi></msub><mtext> </mtext><mi>C</mi><mo stretchy=false >)</mo></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \frac{∂C}{∂t} = -\frac{∂(v_x~C)}{∂x} ~.</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.113em;vertical-align:-0.686em;"></span><span class=mord >−</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.427em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mclose >)</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mord >.</span></span></span></span></span>
<p>In case the flow is incompressible &#40;<span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∇</mi><mo>⋅</mo><mi>v</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\nabla\cdot v = 0</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >∇</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span> - here <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∇</mi><mo>⋅</mo><mi>v</mi><mo>=</mo><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>v</mi><mi>x</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\nabla\cdot v = \frac{∂v_x}{∂x}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class=mord >∇</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >⋅</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.2412079999999999em;vertical-align:-0.345em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8962079999999999em;"><span style="top:-2.6550000000000002em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mathnormal mtight">x</span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4101em;"><span class=pstrut  style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight" style="margin-right:0.05556em;">∂</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class=pstrut  style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>&#41;, the advection equation can be rewritten as</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><msub><mi>v</mi><mi>x</mi></msub><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>x</mi></mrow></mfrac><mtext> </mtext><mi mathvariant=normal >.</mi></mrow><annotation encoding="application/x-tex"> \frac{∂C}{∂t} = -v_x \frac{∂C}{∂x} ~.</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord >−</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace nobreak"> </span><span class=mord >.</span></span></span></span></span>
<p>Let&#39;s implement the advection equation, following the same code structure as for the diffusion and the acoustic wave propagation.</p>
<pre><code class="julia hljs"><span class=hljs-comment ># physics</span>
lx   = <span class=hljs-number >20.0</span>
vx   = <span class=hljs-number >1.0</span></code></pre>
<p>The only change in the <code># derived numerics</code> section is the numerical time step definition to comply with the <a href="https://en.wikipedia.org/wiki/Courant–Friedrichs–Lewy_condition">CFL condition</a> for explicit time integration.</p>
<pre><code class="julia hljs"><span class=hljs-comment ># derived numerics</span>
dt   = dx/abs(vx)</code></pre>
<p>In the <code># array initialisation</code> section, initialise the quantity <code>C</code> as a Gaussian profile of amplitude 1, standard deviation 1, with centre located at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mn>0.3</mn><msub><mi>l</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">c = 0.3 l_x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.84444em;vertical-align:-0.15em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >3</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.01968em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>.</p>
<pre><code class="julia hljs">C = exp.( ... )</code></pre>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >Gaussian distribution as function of coordinate <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">x_c</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy=false >(</mo><msub><mi>x</mi><mi>c</mi></msub><mo>−</mo><mi>c</mi><msup><mo stretchy=false >)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex"> C = \exp(x_c - c)^2 </annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mop >exp</span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class=mclose ><span class=mclose >)</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></div></div>
<p>Update <code>C</code> as following:</p>
<pre><code class="julia hljs">C .-= dt.*vx.*diff(C)./dx <span class=hljs-comment ># doesn&#x27;t work</span></code></pre>
<p>This doesn&#39;t work because of the mismatching array sizes.</p>
<p>There are at least three &#40;naive&#41; ways to solve the problem: update <code>C&#91;1:end-1&#93;</code>, <code>C&#91;2:end&#93;</code>, or one could even update <code>C&#91;2:end-1&#93;</code> with the spatial average of the rate of change <code>dt.*vx.*diff&#40;C&#41;./dx</code>.</p>
<p>👉 Your turn. Try it out yourself and motivate your best choice.</p>
<p>Here we go, an upwind approach is needed to implement a stable advection algorithm</p>
<pre><code class="julia hljs">C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>]   .-= dt.*vx.*diff(C)./dx <span class=hljs-comment ># if vx&gt;0</span>
C[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .-= dt.*vx.*diff(C)./dx <span class=hljs-comment ># if vx&lt;0</span></code></pre>
<h2 id=nonlinear_equations ><a href="#nonlinear_equations" class=header-anchor >Nonlinear equations</a></h2>

<center>
  <video width="80%" autoplay loop controls src="../assets/literate_figures/nonlinear_advection_1D.mp4"/>
</center>


<center>
  <video width="80%" autoplay loop controls src="../assets/literate_figures/nonlinear_diffusion_1D.mp4"/>
</center>

<h2 id=first_step_towards_solving_the_elliptic_problem ><a href="#first_step_towards_solving_the_elliptic_problem" class=header-anchor >First step towards solving the elliptic problem</a></h2>
<p>We have considered numerical solutions to the hyperbolic and parabolic PDEs.</p>
<p>In both cases we used the explicit time integration</p>
<p>The elliptic PDE is different:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 C}{\partial x^2} = 0
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span>
<p>It doesn&#39;t depend on time&#33; How do we solve it numerically then?</p>
<h2 id=solution_to_the_elliptic_pde ><a href="#solution_to_the_elliptic_pde" class=header-anchor >Solution to the elliptic PDE...</a></h2>
<p>is the steady state limit of the time-dependent diffusion problem described by the parabolic PDE:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><msup><mi mathvariant=normal >∂</mi><mn>2</mn></msup><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><msup><mi>x</mi><mn>2</mn></msup></mrow></mfrac><mo>−</mo><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>C</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">
\frac{\partial^2 C}{\partial x^2} - \frac{\partial C}{\partial t} = 0
</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span></span></span></span></span>
<p>when <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>→</mo><mi mathvariant=normal >∞</mi></mrow><annotation encoding="application/x-tex">t\rightarrow\infty</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >→</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class=mord >∞</span></span></span></span>, and we know how to solve parabolic PDEs.</p>
<p>Let&#39;s try to increase the number of time steps <code>nt</code> in our diffusion code to see whether the solution would converge, and decrease the frequency of plotting:</p>
<pre><code class="julia hljs">nt   = nx^<span class=hljs-number >2</span> ÷ <span class=hljs-number >5</span>
nvis = <span class=hljs-number >50</span></code></pre>
<p>and see the results:</p>

<center>
  <video width="80%" autoplay loop controls src="../assets/literate_figures/diffusion_1D_steady_state.mp4"/>
</center>

<p>We approach the steady-state, but the number of time steps required to converge to a solution is proportional to <code>nx^2</code>.</p>
<ul>
<li><p>For simulations in 1D and low resolutions in 2D the quadratic scaling is acceptable.</p>

<li><p>For high-resolution 2D and 3D the <code>nx^2</code> factor becomes prohibitively expensive&#33;</p>

</ul>
<p>We&#39;ll handle this problem in the next lecture, <em>stay tuned&#33;</em></p>
<h2 id=wrapping-up ><a href="#wrapping-up" class=header-anchor >Wrapping-up</a></h2>
<ul>
<li><p>We implemented and solved PDEs for diffusion, wave propagation, and advection processes in 1D</p>

<li><p>We used conservative staggered grid finite-differences, explicit forward Euler time stepping and upwind scheme for advection.</p>

</ul>
<p>Note that this is far from being the only way to tackle numerical solutions to these PDEs. In this course, we will stick to those concepts as they will allow for efficient GPU &#40;parallel&#41; implementations.</p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<h1 id=a_brief_intro_to_git ><a href="#a_brief_intro_to_git" class=header-anchor >A brief intro to Git</a></h1>
<p>Git is a version control software, useful to</p>
<ul>
<li><p>keep track of your progress on code &#40;and other files&#41;</p>

<li><p>to collaborate on code</p>

<li><p>to distribute code, to onself &#40;on other computers&#41; and others</p>

</ul>
<h2 id=previous_experience ><a href="#previous_experience" class=header-anchor >Previous experience</a></h2>
<p>You are familiar with git already:</p>
<p><img src="../assets/literate_figures/survey-git-question.png" alt=git-survey  /></p>
<p>Questions:</p>
<ul>
<li><p>how often do you use git?</p>

<li><p>who has git installed on their laptop?</p>

<li><p>do you use: <code>commit</code>, <code>push</code>, <code>pull</code>, <code>clone</code>?</p>

<li><p>do you use: <code>branch</code>, <code>merge</code>, <code>rebase</code>?</p>

<li><p>GitHub/GitLab etc?</p>

</ul>
<h2 id=a_brief_git_demo_session ><a href="#a_brief_git_demo_session" class=header-anchor >A brief git demo session</a></h2>
<p>Please follow along&#33;</p>
<p>If you don&#39;t have git installed, head to <a href="https://moodle-app2.let.ethz.ch/course/view.php?id&#61;18084">JupyterHub &#40;within Moodle&#41;</a> and open a terminal. &#40;And do install it on your computer&#33;&#41;</p>
<ul>
<li><p>git setup:</p>

</ul>
<pre><code class="sh hljs">git config --global user.name <span class=hljs-string >&quot;Your Name&quot;</span>
git config --global user.email <span class=hljs-string >&quot;youremail@yourdomain.com&quot;</span></code></pre>
<ul>
<li><p>make a repo</p>

<li><p>add some files &#40;<code>add</code>, <code>commit</code>&#41;</p>

<li><p>do some changes &#40;<code>commit</code> some more&#41;</p>

<li><p>make a feature branch &#40;<code>branch</code>, <code>diff</code>, <code>difftool</code>&#41;</p>

<li><p>merge branch &#40;<code>merge</code>&#41;</p>

<li><p>tag &#40;<code>tag</code>&#41;</p>

</ul>
<h2 id=further_reading ><a href="#further_reading" class=header-anchor >Further reading</a></h2>
<p>There are &#40;too&#41; many resources on the web...</p>
<ul>
<li><p>book: <a href="https://git-scm.com/book/en/v2">https://git-scm.com/book/en/v2</a></p>

<li><p>videos: <a href="https://git-scm.com/doc">https://git-scm.com/doc</a></p>

<li><p>cheat sheet &#40;click on boxes&#41; <a href="https://www.ndpsoftware.com/git-cheatsheet.html#loc&#61;workspace;">https://www.ndpsoftware.com/git-cheatsheet.html#loc&#61;workspace;</a></p>

<li><p>get out of a git mess: <a href="http://justinhileman.info/article/git-pretty/git-pretty.png">http://justinhileman.info/article/git-pretty/git-pretty.png</a></p>

</ul>
<h2 id=other_tools_for_git ><a href="#other_tools_for_git" class=header-anchor >Other tools for git</a></h2>
<p>There is plenty of software to interact with git, graphical, command line, etc.  Feel free to use those.</p>
<p>But we will only be able to help you with vanilla, command-line git.</p>
<h2 id=getting_started_on_github_similar_on_gitlab_or_elsewhere ><a href="#getting_started_on_github_similar_on_gitlab_or_elsewhere" class=header-anchor >Getting started on GitHub &#40;similar on GitLab, or elsewhere&#41;</a></h2>
<p>GitHub and GitLab are social coding websites</p>
<ul>
<li><p>they host code</p>

<li><p>they facilitate for developers to interact</p>

<li><p>they provide infrastructure for software testing, deployment, etc</p>

</ul>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >ETH has a GitLab instance which you can use with your NETHZ credentials <a href="https://gitlab.ethz.ch/">https://gitlab.ethz.ch/</a>.</div></div>
<p>Question: who has a GitHub account?</p>
<p>Let&#39;s make one &#40;because most of Julia development happens on GitHub&#41;</p>
<p><a href="https://github.com/">https://github.com/</a> -&gt; &quot;Sign up&quot;</p>
<h2 id=github_setup ><a href="#github_setup" class=header-anchor >GitHub setup</a></h2>
<p>Make such that you can push and pull without entering a password</p>
<p><img src="../assets/literate_figures/github-bar.png" alt=github-bar  /></p>
<ul>
<li><p>local: tell git to store credentials: <code>git config --global credential.helper cache</code></p>

<li><p>github.com:</p>
<ul>
<li><p>&quot;Settings&quot; -&gt; &quot;Developer settings&quot; -&gt; &quot;Personal access tokens&quot; -&gt; &quot;Generate new token&quot;</p>
<ul>
<li><p>Give the token a description/name and select the scope of the token</p>

<li><p>I selected &quot;repo only&quot; to facilitate pull, push, clone, and commit actions</p>

</ul>

<li><p>-&gt; &quot;Generate token&quot; and copy it &#40;keep that website open for now&#41;</p>

</ul>

</ul>
<h2 id=lets_get_our_repo_onto_github ><a href="#lets_get_our_repo_onto_github" class=header-anchor >Let&#39;s get our repo onto GitHub</a></h2>
<p><img src="../assets/literate_figures/github-bar.png" alt=github-bar  /></p>
<ul>
<li><p>create a repository on github.com: click the &quot;&#43;&quot;</p>

<li><p>local: follow setup given on website</p>

<li><p>local: <code>git push</code></p>
<ul>
<li><p>here enter your username &#43; the <strong>token</strong> generated before</p>

</ul>

</ul>
<h2 id=work_with_other_peoples_code_fork ><a href="#work_with_other_peoples_code_fork" class=header-anchor >Work with other peoples code: fork</a></h2>
<p><img src="../assets/literate_figures/github-bar.png" alt=github-bar  /></p>
<ul>
<li><p>fork a repository on github.com &#40;top right&#41;</p>

</ul>
<h2 id=git_questions ><a href="#git_questions" class=header-anchor >Git: questions?</a></h2>
<p><img src="../assets/literate_figures/git-me.png" alt=git-me  /></p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<h1 id=exercises_-_lecture_2 ><a href="#exercises_-_lecture_2" class=header-anchor >Exercises - lecture 2</a></h1>
<h2 id=exercise_1_-_advection-diffusion ><a href="#exercise_1_-_advection-diffusion" class=header-anchor >Exercise 1 - <strong>Advection-Diffusion</strong></a></h2>
<p>👉 <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture2_ex1.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >⚠️ Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to consolidate:</p>
<ul>
<li><p>1D advection-diffusion</p>

<li><p>Non-dimensional numbers</p>

</ul>
<p>The goal of this exercise is to combine advection and diffusion processes acting on the concentration of a quantity <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>.</p>
<p>From what you learned in class, write an advection-diffusion code having following physical input parameters:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># Physics</span>
Lx    = <span class=hljs-number >10.0</span>  <span class=hljs-comment ># domain length</span>
D     = <span class=hljs-number >0.4</span>   <span class=hljs-comment ># diffusion coefficient</span>
vx    = <span class=hljs-number >1.0</span>   <span class=hljs-comment ># advection velocity</span>
ttot  = <span class=hljs-number >2.0</span>   <span class=hljs-comment ># total simulation time</span></code></pre>
<p>Discretise your domain in 128 finite-difference cells such that the first cell centre is located at <code>dx/2</code> and the last cell centre at <code>Lx-dx/2</code>. Use following explicit time step limiters:</p>
<pre><code class="julia hljs">dtd   = dx^<span class=hljs-number >2</span>/D/<span class=hljs-number >2.6</span>
dta   = dx/vx
dt    = min(dtd, dta)</code></pre>
<p>As initial condition, define a Gaussian profile of concentration <code>C</code> of amplitude and standard deviation equal to 1, located at <code>0.3*Lx</code>.</p>
<p>Keep the concentration at the boundaries at <code>C&#61;0</code>.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >Don&#39;t forget to initialise &#40;pre-allocate&#41; all arrays &#40;vectors&#41; needed in the calculations.</div></div>
<h3 id=question_1 ><a href="#question_1" class=header-anchor >Question 1</a></h3>
<p>Report the initial and final distribution of concentration on a figure with axis-label, title, and plotted line labels. Also, report on the figure &#40;as text in one label of your choice&#41; the maximal final concentration value and its x location.</p>
<h3 id=question_2 ><a href="#question_2" class=header-anchor >Question 2</a></h3>
<p>Repeat the exercise but introduce the non-dimensional <a href="https://en.wikipedia.org/wiki/Péclet_number">Péclet number</a> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mo>=</mo><mi>L</mi><mtext> </mtext><mi>v</mi><mi>x</mi><mi mathvariant=normal >/</mi><mi>D</mi></mrow><annotation encoding="application/x-tex">Pe = L~vx/D</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">e</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">L</span><span class="mspace nobreak"> </span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">x</span><span class=mord >/</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> as physical quantity defining the diffusion coefficient D as a <code># Derived physics</code> quantity. Confirm the if <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mo>&gt;</mo><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Pe &gt;&gt; 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">e</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> the diffusion happens in a much longer time compared to the advection, and the opposite for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>e</mi><mo>&lt;</mo><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Pe &lt;&lt; 1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">e</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span></span><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span>.</p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_2_-_reaction-diffusion ><a href="#exercise_2_-_reaction-diffusion" class=header-anchor >Exercise 2 - <strong>Reaction-Diffusion</strong></a></h2>
<p>👉 <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture2_ex2.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >⚠️ Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to consolidate:</p>
<ul>
<li><p>1D reaction-diffusion</p>

<li><p>Non-dimensional numbers</p>

</ul>
<p>The goal of this exercise is to combine reaction and diffusion processes acting on the concentration of a quantity <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span>.</p>
<p>From what you learned in class, write an reaction-diffusion code having following physical input parameters:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># Physics</span>
Lx    = <span class=hljs-number >10.0</span>  <span class=hljs-comment ># domain length</span>
D     = <span class=hljs-number >0.4</span>   <span class=hljs-comment ># diffusion coefficient</span>
ξ     = <span class=hljs-number >10.0</span>  <span class=hljs-comment ># reaction rate</span>
Ceq   = <span class=hljs-number >0.4</span>   <span class=hljs-comment ># equilibrium concentration</span>
ttot  = <span class=hljs-number >2.0</span>   <span class=hljs-comment ># total simulation time</span></code></pre>
<p>Discretise your domain in 128 finite-difference cells such that the first cell centre is located at <code>dx/2</code> and the last cell centre at <code>Lx-dx/2</code>. Use following explicit time step limiters:</p>
<pre><code class="julia hljs">dt    = dx^<span class=hljs-number >2</span>/D/<span class=hljs-number >2.2</span></code></pre>
<p>As initial condition, define a Gaussian profile of concentration <code>C</code> of amplitude and standard deviation equal to 1, located at <code>0.3*Lx</code>.</p>
<p>Keep the concentration at the boundaries at <code>C&#61;0</code>.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >Don&#39;t forget to initialise &#40;pre-allocate&#41; all arrays &#40;vectors&#41; needed in the calculations.</div></div>
<h3 id=question_1__2 ><a href="#question_1__2" class=header-anchor >Question 1</a></h3>
<p>Report the initial and final distribution of concentration on a figure with axis-label, title, and plotted line labels. Also, report on the figure &#40;as text in one label of your choice&#41; the maximal final concentration value and its <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span> location.</p>
<h3 id=question_2__2 ><a href="#question_2__2" class=header-anchor >Question 2</a></h3>
<p>Repeat the exercise but introduce the non-dimensional <a href="https://en.wikipedia.org/wiki/Damköhler_numbers">Damköhler number</a> <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>a</mi><mo>=</mo><msup><mi>L</mi><mn>2</mn></msup><mi mathvariant=normal >/</mi><mi>D</mi><mi mathvariant=normal >/</mi><mi>ξ</mi></mrow><annotation encoding="application/x-tex">Da = L^2/D/ξ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >/</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class=mord >/</span><span class="mord mathnormal" style="margin-right:0.04601em;">ξ</span></span></span></span> as physical quantity defining the diffusion coefficient D as a <code># Derived physics</code> quantity. Confirm the if <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>a</mi><mo>&lt;</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">Da &lt; 0.1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&lt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mord >.</span><span class=mord >1</span></span></span></span> most of the mass diffuses away from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mrow><mi>e</mi><mi>q</mi></mrow></msub></mrow><annotation encoding="application/x-tex">C_{eq}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.969438em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>, and the opposite holds for <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>a</mi><mo>&gt;</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">Da &gt; 10</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">a</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >&gt;</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span><span class=mord >0</span></span></span></span>.</p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_3_-_nonlinear_problems ><a href="#exercise_3_-_nonlinear_problems" class=header-anchor >Exercise 3 - <strong>Nonlinear problems</strong></a></h2>
<p>👉 <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/exercise-notebooks/notebooks/lecture2_ex3.ipynb">Download the notebook to get started with this exercise&#33;</a></p>
<div class=warning ><div class=title >⚠️ Warning&#33;</div>
<div class=messg >Write a monolithic Julia script to solve this exercise in a Jupyter notebook and hand it in on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<p>The goal of this exercise is to consolidate:</p>
<ul>
<li><p>Nonlinear processes</p>

<li><p>...</p>

</ul>
<p>The goal of this exercise is to ...</p>
<h3 id=question_1__3 ><a href="#question_1__3" class=header-anchor >Question 1</a></h3>
<p>TBD</p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_4_-_julia_install_and_git_repo ><a href="#exercise_4_-_julia_install_and_git_repo" class=header-anchor >Exercise 4 - <strong>Julia install and Git repo</strong></a></h2>
<p>The goal of this homework is to:</p>
<ul>
<li><p>finalise your local Julia install</p>

<li><p>create a private git repo to upload your homework</p>

</ul>
<p>As final homework task for this second lecture, you will have to</p>
<ol>
<li><p>Finalise your local Julia install</p>

<li><p>Create a private git repository on GitHub and share it only with the teaching staff</p>

</ol>
<h3 id=julia_install ><a href="#julia_install" class=header-anchor >Julia install</a></h3>
<p>Ensure you have access to</p>
<ul>
<li><p>the latest version of Julia &#40;&gt;&#61; v1.6&#41;</p>

<li><p>a fully functional REPL &#40;command window&#41;</p>

</ul>
<p>You should be able to visualise scripts&#39; output graphically when, e.g., plotting something:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Plots
display(heatmap(rand(<span class=hljs-number >10</span>,<span class=hljs-number >10</span>)))</code></pre>
<p><img src="../assets/literate_figures/random-noise.png" alt=random-noise  /></p>
<h3 id=git_repository ><a href="#git_repository" class=header-anchor >Git repository</a></h3>
<p>Once you have your GitHub account ready &#40;see lecture 2 <a href="/lecture2/#a_brief_git_demo_session">how-to</a>&#41;, create a private repository you will <em><strong>share with the teaching staff only</strong></em> to upload your weekly assignments &#40;scripts&#41;:</p>
<ol>
<li><p>Create a private GitHub repository named <code>pde-on-gpu-&lt;lastname&gt;</code>, where <code>&lt;lastname&gt;</code> has to be replaced by your last name. Select an <code>MIT License</code> and add a <code>README</code>.</p>

<li><p>Share this private repository on GitHub with the teaching staff: <a href="https://github.com/luraess">luraess</a>, <a href="https://github.com/utkinis">utkinis</a>, <a href="https://github.com/mauro3">mauro3</a>, <a href="https://github.com/omlins">omlins</a></p>

<li><p><strong>For each homework submission</strong>, you will:</p>
<ul>
<li><p>create a new folder named <code>lectureX</code> &#40;X <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo><mo stretchy=false >[</mo><mn>3</mn><mo>−</mo><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mi mathvariant=normal >.</mi><mo stretchy=false >]</mo></mrow><annotation encoding="application/x-tex">\in [3-...]</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.5782em;vertical-align:-0.0391em;"></span><span class=mrel >∈</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >[</span><span class=mord >3</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >.</span><span class=mord >.</span><span class=mord >.</span><span class=mclose >]</span></span></span></span>&#41; to push the exercise codes into;</p>

<li><p>copy <strong>the single git commit hash &#40;or SHA&#41; of the final push</strong> and upload it on <a href="https://moodle-app2.let.ethz.ch/course/view.php?id&#61;18084">Moodle</a>. It will serve to control the material was pushed on time.</p>

</ul>

</ol>
<p>👉 See <a href="/logistics/#submission">Logistics</a> for details.</p>
<h3 id=github_task ><a href="#github_task" class=header-anchor >GitHub task</a></h3>
<p>For this week, edit the <code>README.md</code> of your private repository:</p>
<ul>
<li><p>Add one or two description sentences in there &#40;to get familiar with the Markdown syntax&#41;.</p>

<li><p>Then <code>commit</code> the change and <code>push</code> it.</p>

<li><p>Copy the commit hash &#40;or SHA&#41; and past it to <a href="https://moodle-app2.let.ethz.ch/course/view.php?id&#61;18084">Moodle</a> in the <em>git commit hash &#40;SHA&#41;</em> activity.</p>

</ul>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<div class=page-foot >
  <div class=copyright >
    <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/"><b>Edit this page on <img class=github-logo  src="https://unpkg.com/ionicons@5.1.2/dist/svg/logo-github.svg"></b></a><br>
    Last modified: September 19, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>