<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <script src="/libs/lunr/lunr.min.js"></script> <script src="/libs/lunr/lunr_index.js"></script> <script src="/libs/lunr/lunrclient.min.js"></script> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_hyde.css"> <link rel=stylesheet  href="/css/custom.css"> <style> html {font-size: 17px;} .franklin-content {position: relative; padding-left: 8%; padding-right: 5%; line-height: 1.35em;} @media (min-width: 940px) { .franklin-content {width: 100%; margin-left: auto; margin-right: auto;} } @media (max-width: 768px) { .franklin-content {padding-left: 6%; padding-right: 6%;} } </style> <link rel=icon  href="/assets/favicon.png"> <title>Lecture 8</title> <style> .content {max-width: 50rem} </style> <div class=sidebar > <div class="container sidebar-sticky"> <div class=sidebar-about > <img src="/assets/vaw_logo.png" style="width: 180px; height: auto; display: inline"> <div style="font-weight: margin-bottom: 0.5em"><a href="/"> Fall 2022</a> <span style="opacity: 0.7;">| <a href="http://www.vvz.ethz.ch/Vorlesungsverzeichnis/lerneinheit.view?semkez=2022W&ansicht=KATALOGDATEN&lerneinheitId=162403&lang=en"> ETHZ 101-0250-00</a></span></div> <br> <h1><a href="/">Solving partial differential equations in parallel on GPUs</a></h1> <div style="line-height:18px; font-size: 15px; opacity: 0.85">by &nbsp; <a href="https://vaw.ethz.ch/en/people/person-detail.MjcwOTYw.TGlzdC8xOTYxLDE1MTczNjI1ODA=.html">Ludovic Räss</a>, &nbsp; <a href="https://vaw.ethz.ch/en/personen/person-detail.html?persid=124402">Mauro Werder</a>, &nbsp; <a href="https://www.cscs.ch/about/staff/">Samuel Omlin</a> & <br> <a href="https://vaw.ethz.ch/en/people/person-detail.MzAwMjIy.TGlzdC8xOTYxLDE1MTczNjI1ODA=.html">Ivan Utkin</a> </div> </div> <br> <style> </style> <nav class=sidebar-nav  style="opacity: 0.9; margin-bottom: 1.2cm;"> <a class="sidebar-nav-item " href="/"><b>Welcome</b></a> <a class="sidebar-nav-item " href="/logistics/">Logistics</a> <a class="sidebar-nav-item " href="/homework/">Homework</a> <a class="sidebar-nav-item " href="/software_install/">Software install</a> <a class="sidebar-nav-item " href="/extras/">Extras</a> <br> <div class=course-section >Part 1 - Introduction</div> <a class="sidebar-nav-item " href="/lecture1/">Lecture 1 - Why Julia GPU</a> <a class="sidebar-nav-item " href="/lecture2/">Lecture 2 - PDEs & physical processes</a> <a class="sidebar-nav-item " href="/lecture3/">Lecture 3 - Solving elliptic PDEs</a> <div class=course-section >Part 2 - Solving PDEs on GPUs</div> <a class="sidebar-nav-item " href="/lecture4/">Lecture 4 - Porous convection</a> <a class="sidebar-nav-item " href="/lecture5/">Lecture 5 - Parallel computing</a> <a class="sidebar-nav-item " href="/lecture6/">Lecture 6 - GPU computing & perf</a> <div class=course-section >Part 3 - Multi-GPU computing (projects)</div> <a class="sidebar-nav-item " href="/lecture7/">Lecture 7 - XPU computing</a> <a class="sidebar-nav-item active" href="/lecture8/">Lecture 8 - Julia MPI & multi-XPU</a> <a class="sidebar-nav-item " href="/lecture9/">Lecture 9 - Advanced optimisations</a> <div class=course-section >Final Projects</div> <a class="sidebar-nav-item " href="/lecture10/">Lecture 10 - Final projects</a> </nav> <form id=lunrSearchForm  name=lunrSearchForm > <input class=search-input  name=q  placeholder="Enter search term" type=text > <input type=submit  value=Search  formaction="/search/index.html"> </form> <br> <br> </div> </div> <div class="content container"> <div class=franklin-content > <h1 id=lecture_8 ><a href="#lecture_8" class=header-anchor >Lecture 8</a></h1> <blockquote> <p><strong>Agenda</strong><br />📚 Distributed multi-XPU computing, MPI, Stokes flow<br />💻 Automatic documentation<br />🚧 Exercises:</p> <ul> <li><p>Fake-parallelisation, Julia MPI, <code>ImplicitGlobalGrid.jl</code></p> <li><p>Fluid dynamics: Navier-Stokes equations, incompressible Stokes flow </p> <li><p>Automatic documentation and CI</p> </ul> </blockquote> <hr /> <p><a id=content  class=anchor ></a> <strong>Content</strong></p> <div class=franklin-toc ><ol><li><a href="#lecture_8">Lecture 8</a><li><a href="#distributed_computing_in_julia">Distributed computing in Julia</a><ol><li><a href="#new_to_distributed_computing">New to distributed computing?</a><li><a href="#fake_parallelisation">Fake parallelisation</a><li><a href="#julia_and_mpi">Julia and MPI</a><li><a href="#using_implicitglobalgridjl">Using <code>ImplicitGlobalGrid.jl</code></a><li><a href="#towards_stokes_ii_navier-stokes_flow">Towards Stokes II: Navier-Stokes flow</a></ol><li><a href="#documenting_your_code">Documenting your code</a><li><a href="#exercises_-_lecture_8">Exercises - lecture 8</a><ol><li><a href="#exercise_1_-_towards_distributed_memory_computing_on_gpus">Exercise 1 - <strong>Towards distributed memory computing on GPUs</strong></a><li><a href="#exercise_2_-_multi-xpu_computing">Exercise 2 - <strong>Multi-XPU computing</strong></a><li><a href="#exercise_3_-_navier-stokes_flow">Exercise 3 - <strong>Navier-Stokes flow</strong></a><li><a href="#exercise_4_-_automatic_documentation_in_julia">Exercise 4 - <strong>Automatic documentation in Julia</strong></a></ol></ol></div> <p><a href="#exercises_-_lecture_8"><em>👉 get started with exercises</em></a></p> <hr /> <h1 id=distributed_computing_in_julia ><a href="#distributed_computing_in_julia" class=header-anchor >Distributed computing in Julia</a></h1> <h3 id=the_goal_of_this_lecture_8 ><a href="#the_goal_of_this_lecture_8" class=header-anchor >The goal of this lecture 8:</a></h3> <ul> <li><p>Distributed computing</p> <ul> <li><p>Fake parallelisation</p> <li><p>Julia MPI &#40;CPU &#43; GPU&#41;</p> <li><p>Using <code>ParallelStencil.jl</code> together with <code>ImplicitGlobalGrid.jl</code></p> <li><p>Towards Stokes II: elastic to viscous &#40;Cauchy-Navier to &#40;Navier-&#41;Stokes&#41;</p> </ul> <li><p>Automatic documentation and CI</p> </ul> <h2 id=new_to_distributed_computing ><a href="#new_to_distributed_computing" class=header-anchor >New to distributed computing?</a></h2> <p><em>If this is the case or not - hold-on, we certainly have some good stuff for everyone</em></p> <h3 id=distributed_computing ><a href="#distributed_computing" class=header-anchor >Distributed computing</a></h3> <p>Adds one additional layer of parallelisation:</p> <ul> <li><p>Global problem does no longer &quot;fit&quot; within a single compute node &#40;or GPU&#41;</p> <li><p>Local resources &#40;mainly memory&#41; are finite, e.g.,</p> <ul> <li><p>CPUs: increase the number of cores beyond what a single CPU can offer</p> <li><p>GPUs: overcome the device memory limitation</p> </ul> </ul> <p>Simply said:</p> <p><em>If one CPU or GPU is not sufficient to solve a problem, then use more than one and solve a subset of the global problem on each.</em></p> <p>Distributed &#40;memory&#41; computing permits to take advantage of computing &quot;clusters&quot;, many similar compute nodes interconnected by high-throughput network. That&#39;s also what supercomputers are.</p> <h3 id=parallel_scaling ><a href="#parallel_scaling" class=header-anchor >Parallel scaling</a></h3> <p>So here we go. Let&#39;s assume we want to solve a certain problem, which we will call the &quot;global problem&quot;. This global problem, we split then into several local problems that execute concurrently.</p> <p>Two scaling approaches exist:</p> <ul> <li><p>strong scaling</p> <li><p>weak scaling</p> </ul> <p>Increasing the amount of computing resources to resolve the same global problem would increase parallelism and may result in faster execution &#40;wall-time&#41;. This parallelisation is called <em><strong>strong scaling</strong></em>; the resources are increased but the global problem size does not change, resulting in an increase in the number of &#40;smaller&#41; local problems that can be solved in parallel.</p> <p>The <em><strong>strong scaling</strong></em> approach is often used when parallelising legacy CPU codes, as increasing the number of parallel local problems can lead to some speed-up, reaching an optimum beyond which additional local processes is no longer be beneficial.</p> <p>However, we won&#39;t follow that path when developing parallel multi-GPU applications from scratch. Why?</p> <p><em>Because GPUs&#39; performance is very sensitive to the local problem size as we experienced when trying to tune the kernel launch parameters &#40;threads, blocks, i.e., the local problem size&#41;.</em></p> <p>When developing multi-GPU applications from scratch, it is likely more suitably to approach distributed parallelisation from a <em><strong>weak scaling</strong></em> perspective; defining first the optimal local problem size to resolve on a single GPU and then increasing the number of optimal local problems &#40;and the number of GPUs&#41; until reaching the global problem one originally wants to solve.</p> <h3 id=implicit_global_grid ><a href="#implicit_global_grid" class=header-anchor >Implicit Global Grid</a></h3> <p>We can thus replicate a local problem multiple times in each dimension of the Cartesian space to obtain a global grid, which is therefore defined implicitly. Local problems define each others local boundary conditions by exchanging internal boundary values using intra-node communication &#40;e.g., message passing interface - <a href="https://en.wikipedia.org/wiki/Message_Passing_Interface">MPI</a>&#41;, as depicted on the <a href="https://github.com/eth-cscs/ImplicitGlobalGrid.jl">figure</a> hereafter:</p> <p><img src="../assets/literate_figures/l8_igg.png" alt=IGG  /></p> <h3 id=distributing_computations_-_challenges ><a href="#distributing_computations_-_challenges" class=header-anchor >Distributing computations - challenges</a></h3> <p>Many things could potentially go wrong in distributed computing. However, the ultimate goal &#40;at least for us&#41; is to keep up with <em><strong>parallel efficiency</strong></em>.</p> <p>The parallel efficiency defines as the speedup divided by the numebr of processors. The speed-up defines as the execution time using an increasing number of processors normalised by the single processor execution time. We will use the parallel efficiency in a weak scaling configuration.</p> <p>Ideally, the parallel efficiency should stay close to 1 while increasing the number of computing resources proportionally with the global problem size &#40;i.e. keeping the constant local problem sizes&#41;, meaning no time is lost &#40;no overhead&#41; in due to, e.g., inter-process communication, network congestion, congestion of shared filesystem, etc... as shown in the <a href="https://github.com/eth-cscs/ImplicitGlobalGrid.jl">figure</a> hereafter:</p> <p><img src="../assets/literate_figures/l8_par_eff.png" alt="Parallel scaling" /></p> <hr /> <h3 id=lets_get_started ><a href="#lets_get_started" class=header-anchor >Let&#39;s get started</a></h3> <p>we will explore distributed computing with Julia&#39;s MPI wrapper MPI.jl. This will enable our codes to run on multiple CPUs and GPUs in order to scale on modern multi-CPU/GPU nodes, clusters and supercomputers. In the proposed approach, each MPI process handles one CPU or GPU.</p> <p>We&#39;re going to work out the following steps to tackle distributed parallelisation in this lecture &#40;in 5 tasks&#41;:</p> <ul> <li><p><a href="#fake_parallelisation"><strong>Fake parallelisation</strong> as proof-of-concept</a></p> <li><p><a href="#julia_and_mpi"><strong>Julia and MPI</strong></a></p> </ul> <h2 id=fake_parallelisation ><a href="#fake_parallelisation" class=header-anchor >Fake parallelisation</a></h2> <p>As a first step, we will look at the below 1-D diffusion code which solves the linear diffusion equations using a &quot;fake-parallelisation&quot; approach. We split the calculation on two distinct left and right domains, which requires left and right <code>C</code> arrays, <code>CL</code> and <code>CR</code>, respectively.</p> <p>In this &quot;fake parallelisation&quot; code, the computations for the left and right domain are performed sequentially on one process, but they could be computed on two distinct processes if the needed boundary update &#40;often referred to as halo update in literature&#41; was done with MPI.</p> <p><img src="../assets/literate_figures/l8_1D_global_grid.png" alt="1D Global grid" /></p> <p>The idea of this fake parallelisation approach is the following:</p> <pre><code class="julia hljs"><span class=hljs-comment ># Compute physics locally</span>
CL[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .= CL[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .+ dt*D*diff(diff(CL)/dx)/dx
CR[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .= CR[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .+ dt*D*diff(diff(CR)/dx)/dx
<span class=hljs-comment ># Update boundaries (MPI)</span>
CL[<span class=hljs-keyword >end</span>] = ...
CR[<span class=hljs-number >1</span>]   = ...
<span class=hljs-comment ># Global picture</span>
C .= [CL[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>]; CR[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>]]</code></pre> <p>We see that a correct boundary update will be the critical part for a successful implementation. In our approach, we need an overlap of 2 cells between <code>CL</code> and <code>CR</code> in order to avoid any wrong computations at the transition between the left and right domains.</p> <h3 id=task_1_fake_parallelisation_with_2_fake_processes ><a href="#task_1_fake_parallelisation_with_2_fake_processes" class=header-anchor >Task 1 &#40;fake parallelisation with 2 fake processes&#41;</a></h3> <p>Run the &quot;fake parallelisation&quot; 1-D diffusion code <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_1D_2procs.jl"><code>diffusion_1D_2procs.jl</code></a> &#40;also available in your <code>/scratch/&lt;username&gt;/lecture08</code> directory on <code>octopus</code>&#41;, which is missing the boundary updates of the 2 fake processes and describe what you see in the visualisation.</p> <p>Then, add the required boundary update:</p> <pre><code class="julia hljs"><span class=hljs-comment ># Update boundaries (MPI)</span>
CL[<span class=hljs-keyword >end</span>] = ...
CR[<span class=hljs-number >1</span>]   = ...</code></pre> <p>in order make the code work properly and run it again. Note what has changed in the visualisation.</p> <div class=img-med ><img src="../assets/literate_figures/l8_diff_1D_2procs_1.gif" alt="diffusion 1D 2 procs" /></div> <p>The next step will be to generalise the fake parallelisation with <code>2</code> fake processes to work with <code>n</code> fake processes. The idea of this generalised fake parallelisation approach is the following:</p> <pre><code class="julia hljs"><span class=hljs-keyword >for</span> ip = <span class=hljs-number >1</span>:np <span class=hljs-comment ># compute physics locally</span>
    C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>,ip] .= C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>,ip] .+ dt*D*diff(diff(C[:,ip])/dxg)/dxg
<span class=hljs-keyword >end</span>
<span class=hljs-keyword >for</span> ip = <span class=hljs-number >1</span>:np-<span class=hljs-number >1</span> <span class=hljs-comment ># update boundaries</span>
   <span class=hljs-comment ># ...</span>
<span class=hljs-keyword >end</span>
<span class=hljs-keyword >for</span> ip = <span class=hljs-number >1</span>:np <span class=hljs-comment ># global picture</span>
    i1 = <span class=hljs-number >1</span> + (ip-<span class=hljs-number >1</span>)*(nx-<span class=hljs-number >2</span>)
    Cg[i1:i1+nx-<span class=hljs-number >2</span>] .= C[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>,ip]
<span class=hljs-keyword >end</span></code></pre> <p>The array <code>C</code> contains now <code>n</code> local domains where each domain belongs to one fake process, namely the fake process indicated by the second index of <code>C</code> &#40;ip&#41;. The boundary updates are to be adapted accordingly. All the physical calculations happen on the local chunks of the arrays. We only need &quot;global&quot; knowledge in the definition of the initial condition.</p> <p>The previous simple initial conditions can be easily defined without computing any Cartesian coordinates. To define other initial conditions we often need to compute global coordinates. In the code below, which serves to define a Gaussian anomaly in the centre of the domain, Cartesian coordinates can be computed for each cell based on the process ID &#40;<code>ip</code>&#41;, the cell ID &#40;<code>ix</code>&#41;, the array size &#40;<code>nx</code>&#41;, the overlap of the local domains &#40;<code>2</code>&#41; and the grid spacing of the global grid &#40;<code>dxg</code>&#41;; moreover, the origin of the coordinate system can be moved to any position using the global domain length &#40;<code>lx</code>&#41;:</p> <pre><code class="julia hljs"><span class=hljs-comment ># Initial condition</span>
<span class=hljs-keyword >for</span> ip = <span class=hljs-number >1</span>:np
    <span class=hljs-keyword >for</span> ix = <span class=hljs-number >1</span>:nx
        x[ix,ip] = ...
        C[ix,ip] = exp(-x[ix,ip]^<span class=hljs-number >2</span>)
    <span class=hljs-keyword >end</span>
    i1 = <span class=hljs-number >1</span> + (ip-<span class=hljs-number >1</span>)*(nx-<span class=hljs-number >2</span>)
    xt[i1:i1+nx-<span class=hljs-number >2</span>] .= x[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>,ip]; <span class=hljs-keyword >if</span> (ip==np) xt[i1+nx-<span class=hljs-number >1</span>] = x[<span class=hljs-keyword >end</span>,ip] <span class=hljs-keyword >end</span>
    Ct[i1:i1+nx-<span class=hljs-number >2</span>] .= C[<span class=hljs-number >1</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>,ip]; <span class=hljs-keyword >if</span> (ip==np) Ct[i1+nx-<span class=hljs-number >1</span>] = C[<span class=hljs-keyword >end</span>,ip] <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span></code></pre> <h3 id=task_2_fake_parallelisation_with_n_fake_processes ><a href="#task_2_fake_parallelisation_with_n_fake_processes" class=header-anchor >Task 2 &#40;fake parallelisation with <code>n</code> fake processes&#41;</a></h3> <p>Modify the initial condition in the 1-D diffusion code <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_1D_nprocs.jl"><code>diffusion_1D_nprocs.jl</code></a> &#40;also available in your <code>/scratch/&lt;username&gt;/lecture08</code> directory on <code>octopus</code>&#41; to a centred <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy=false >(</mo><msub><mi>L</mi><mi>x</mi></msub><mi mathvariant=normal >/</mi><mn>2</mn><mo stretchy=false >)</mo></mrow><annotation encoding="application/x-tex">(L_x/2)</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mopen >(</span><span class=mord ><span class="mord mathnormal">L</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord >2</span><span class=mclose >)</span></span></span></span> Gaussian anomaly.</p> <p>Then run this code which is missing the boundary updates of the <code>n</code> fake processes and describe what you see in the visualisation. Then, add the required boundary update in order make the code work properly and run it again. Note what has changed in the visualisation.</p> <div class=img-med ><img src="../assets/literate_figures/l8_diff_1D_nprocs_1.gif" alt="diffusion 1D n procs" /></div> <h2 id=julia_and_mpi ><a href="#julia_and_mpi" class=header-anchor >Julia and MPI</a></h2> <p>We are now ready to write a code that will truly distribute calculations on different processors using <a href="https://github.com/JuliaParallel/MPI.jl">MPI.jl</a> for inter-process communication.</p> <div class=note ><div class=title >💡 Note</div> <div class=messg >At this point, make sure to have a working Julia MPI environment. Head to <a href="/software_install/#julia_mpi">Julia MPI install</a> to set-up Julia MPI. See <a href="/software_install/#julia_mpi_gpu_on_your_octopus_node">Julia MPI GPU on your <code>octopus</code> node</a> for detailed information on how to run MPI GPU &#40;multi-GPU&#41; applications on your assigned <code>octopus</code> node.</div></div> <p>Let us see what are the somewhat minimal requirements that will allow us to write a distributed code in Julia using MPI.jl. We will solve the following linear diffusion physics:</p> <pre><code class="julia hljs"><span class=hljs-keyword >for</span> it = <span class=hljs-number >1</span>:nt
    qx         .= .-D*diff(C)/dx
    C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .= C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>] .- dt*diff(qx)/dx
<span class=hljs-keyword >end</span></code></pre> <p>To enable distributed parallelisation, we will do the following steps:</p> <ol> <li><p>Initialise MPI and set up a Cartesian communicator</p> <li><p>Implement a boundary exchange routine</p> <li><p>Create a &quot;global&quot; initial condition</p> <li><p>Finalise MPI</p> </ol> <p>To &#40;1.&#41; initialise MPI and prepare the Cartesian communicator, we do:</p> <pre><code class="julia hljs">MPI.Init()
dims        = [<span class=hljs-number >0</span>]
comm        = MPI.COMM_WORLD
nprocs      = MPI.Comm_size(comm)
MPI.Dims_create!(nprocs, dims)
comm_cart   = MPI.Cart_create(comm, dims, [<span class=hljs-number >0</span>], <span class=hljs-number >1</span>)
me          = MPI.Comm_rank(comm_cart)
coords      = MPI.Cart_coords(comm_cart)
neighbors_x = MPI.Cart_shift(comm_cart, <span class=hljs-number >0</span>, <span class=hljs-number >1</span>)</code></pre> <p>where <code>me</code> represents the process ID unique to each MPI process &#40;the analogue to <code>ip</code> in the fake parallelisation&#41;.</p> <p>Then, we need to &#40;2.&#41; implement a boundary update routine, which can have the following structure:</p> <pre><code class="julia hljs"><span class=hljs-meta >@views</span> <span class=hljs-keyword >function</span> update_halo(A, neighbors_x, comm)
    <span class=hljs-comment ># Send to / receive from neighbor 1 (&quot;left neighbor&quot;)</span>
    <span class=hljs-keyword >if</span> neighbors_x[<span class=hljs-number >1</span>] != MPI.MPI_PROC_NULL
        <span class=hljs-comment ># ...</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-comment ># Send to / receive from neighbor 2 (&quot;right neighbor&quot;)</span>
    <span class=hljs-keyword >if</span> neighbors_x[<span class=hljs-number >2</span>] != MPI.MPI_PROC_NULL
        <span class=hljs-comment ># ...</span>
    <span class=hljs-keyword >end</span>
    <span class=hljs-keyword >return</span>
<span class=hljs-keyword >end</span></code></pre> <p>Then, we &#40;3.&#41; initialize <code>C</code> with a &quot;global&quot; initial Gaussian anomaly that spans correctly over all local domains. This can be achieved, e.g., as given here:</p> <pre><code class="julia hljs">x0    = coords[<span class=hljs-number >1</span>]*(nx-<span class=hljs-number >2</span>)*dx
xc    = [x0 + ix*dx - dx/<span class=hljs-number >2</span> - <span class=hljs-number >0.5</span>*lx  <span class=hljs-keyword >for</span> ix=<span class=hljs-number >1</span>:nx]
C     = exp.(.-xc.^<span class=hljs-number >2</span>)</code></pre> <p>where <code>x0</code> represents the first global x-coordinate on every process &#40;computed in function of <code>coords</code>&#41; and <code>xc</code> represents the local chunk of the global coordinates on each local process &#40;this is analogue to the initialisation in the fake parallelisation&#41;.</p> <p>Last, we need to &#40;4.&#41; finalise MPI prior to returning from the main function:</p> <pre><code class="julia hljs">MPI.Finalize()</code></pre>
<p>All the above described is found in the code <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_1D_mpi.jl"><code>diffusion_1D_mpi.jl</code></a> &#40;also available in your <code>/scratch/&lt;username&gt;/lecture08</code> directory on <code>octopus</code>&#41;, except for the boundary updates &#40;see 2.&#41;.</p>
<h3 id=task_3_1-d_parallelisation_with_mpi ><a href="#task_3_1-d_parallelisation_with_mpi" class=header-anchor >Task 3 &#40;1-D parallelisation with MPI&#41;</a></h3>
<p>Run the code <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_1D_mpi.jl"><code>diffusion_1D_mpi.jl</code></a> which is still missing the boundary updates three times: with 1, 2 and 4 processes &#40;replacing <code>np</code> by the number of processes and <code>&lt;username&gt;</code> with your username on <code>octopus</code>&#41;:</p>
<pre><code class="sh hljs">/home/&lt;username&gt;/.julia/bin/mpiexecjl -n np julia --project &lt;my_script.jl&gt;</code></pre>
<p>Visualise the results after each run with the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/vizme1D_mpi.jl"><code>vizme1D_mpi.jl</code></a> code &#40;adapt the variable <code>nprocs</code>&#33;&#41;. Describe what you see in the visualisation. Then, add the required boundary update in order make the code work properly and run it again. Note what has changed in the visualisation.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >For the boundary updates, you can use the following approach for the communication with each neighbor: 1&#41; create a sendbuffer and receive buffer, storing the right value in the send buffer; 2&#41; use <code>MPI.Send</code> and <code>MPI.Recv&#33;</code> to send/receive the data; 3&#41; store the received data in the right position in the Array.</div></div>
<p>Congratulations&#33; You just did a distributed diffusion solver in only 70 lines of code.</p>
<p>Let us now do the same in 2D: there is not much new there, but it may be interesting to work out how boundary update routines can be defined in 2D as one now needs to exchange vectors instead of single values.</p>
<h3 id=task_4_2-d_parallelisation_with_mpi ><a href="#task_4_2-d_parallelisation_with_mpi" class=header-anchor >Task 4 &#40;2-D parallelisation with MPI&#41;</a></h3>
<p>Run the code <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_2D_mpi.jl"><code>diffusion_2D_mpi.jl</code></a> which is still missing the boundary updates three times: with 1, 2 and 4 processes.</p>
<p>Visualise the results after each run with the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/vizme2D_mpi.jl"><code>vizme2D_mpi.jl</code></a> code &#40;adapt the variable <code>nprocs</code>&#33;&#41;. Describe what you see in the visualisation. Then, add the required boundary update in order make the code work properly and run it again. Note what has changed in the visualisation.</p>
<div class=img-med ><img src="../assets/literate_figures/l8_diffusion_2D_xpu_1.gif" alt="diffusion 2D MPI" /></div>
<p>The last step is to create a multi-GPU solver out of the above multi-CPU solver. CUDA-aware MPI is of great help in this task, because it allows to directly pass GPU arrays to the MPI functions.</p>
<p>Besides facilitating the programming, it can leverage Remote Direct Memory Access &#40;RDMA&#41; which can be of great benefit in many HPC scenarios.</p>
<h3 id=task_5_multi-gpu_homework ><a href="#task_5_multi-gpu_homework" class=header-anchor >Task 5 &#40;multi-GPU&#41; <em><strong>HOMEWORK</strong></em></a></h3>
<p>Translate the code <code>diffusion_2D_mpi.jl</code> from Task 4 to GPU using GPU array programming. Note what changes were needed to go from CPU to GPU in this distributed solver.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >You can use a similar approach as in the CPU code to perform the boundary updates. You can use <code>copyto&#33;</code> function in order to copy the data from the GPU memory into the send buffers &#40;CPU memory&#41; or to copy the receive buffer data to the GPU array.</div></div>
<p>Head to the <a href="#exercises_-_lecture_8">exercise section</a> for further directions on this task which is part of this week&#39;s homework assignments.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >As alternative, one could use the same approach as in the CPU code to perform the boundary updates thanks to CUDA-aware MPI &#40;it allows to pass GPU arrays directly to the MPI functions&#41;. However, this requires MPI being specifically built to that purpose.</div></div>
<p>This completes the introduction to distributed parallelisation with Julia.</p>
<p>Note that high-level Julia packages as for example <a href="https://github.com/eth-cscs/ImplicitGlobalGrid.jl">ImplicitGlobalGrid.jl</a> can render distributed parallelisation with GPU and CPU for HPC a very simple task. Let&#39;s check it out&#33;</p>
<h2 id=using_implicitglobalgridjl ><a href="#using_implicitglobalgridjl" class=header-anchor >Using <code>ImplicitGlobalGrid.jl</code></a></h2>
<p>Let&#39;s have look at <a href="https://github.com/eth-cscs/ImplicitGlobalGrid.jl">ImplicitGlobalGrid.jl</a>&#39;s repository.</p>
<p>ImplicitGlobalGrid.jl can render distributed parallelisation with GPU and CPU for HPC a very simple task. Moreover, ImplicitGlobalGrid.jl elegantly combines with <a href="https://github.com/omlins/ParallelStencil.jl">ParallelStencil.jl</a>.</p>
<p>Finally, the cool bit: using both packages together enables to <a href="https://github.com/omlins/ParallelStencil.jl#seamless-interoperability-with-communication-packages-and-hiding-communication">hide communication behind computation</a>. This feature enables a parallel efficiency close to 1.</p>
<p>For this demo, we&#39;ll start from the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_2D_perf_xpu.jl"><code>diffusion_2D_perf_xpu.jl</code></a> code &#40;also available in your <code>/scratch/&lt;username&gt;/lecture08</code> directory on <code>octopus</code>&#41;.</p>
<p>Only a few changes are required to enable multi-XPU execution, namely:</p>
<ol>
<li><p>initialise the implicit global grid</p>

<li><p>use global coordinates to compute the initial condition</p>

<li><p>update halo &#40;and overlap communication with computation&#41;</p>

<li><p>finalise the global grid</p>

<li><p>tune visualisation</p>

</ol>
<p>To &#40;1.&#41; initialise the global grid, one first needs to use the package</p>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> ImplicitGlobalGrid</code></pre>
<p>Then, one can add the global grid initialisation in the <code># Derived numerics</code> section</p>
<pre><code class="julia hljs">me, dims = init_global_grid(nx, ny, <span class=hljs-number >1</span>)  <span class=hljs-comment ># Initialization of MPI and more...</span>
<span class=hljs-meta >@static</span> <span class=hljs-keyword >if</span> USE_GPU select_device() <span class=hljs-keyword >end</span>  <span class=hljs-comment ># select one GPU per MPI local rank (if &gt;1 GPU per node)</span>
dx, dy  = Lx/nx_g(), Ly/ny_g()</code></pre>
<p>Note that we include the <code>select_device&#40;&#41;</code> function to map each MPI process to a unique GPU on the node.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >Have a look at the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/hello_mpi_gpu.jl"><code>hello_mpi_gpu.jl</code></a> code to get an idea on how to select unique GPU using node-local MPI infos.</div></div>
<p>Then, for &#40;2.&#41;, one can use <code>x_g&#40;&#41;</code> and <code>y_g&#40;&#41;</code> to compute the global coordinates in the initialisation &#40;to correctly spread the Gaussian distribution over all local processes&#41;</p>
<pre><code class="julia hljs">C       = <span class=hljs-meta >@zeros</span>(nx,ny)
C      .= Data.<span class=hljs-built_in >Array</span>([exp(-(x_g(ix,dx,C)+dx/<span class=hljs-number >2</span> -Lx/<span class=hljs-number >2</span>)^<span class=hljs-number >2</span> -(y_g(iy,dy,C)+dy/<span class=hljs-number >2</span> -Ly/<span class=hljs-number >2</span>)^<span class=hljs-number >2</span>) <span class=hljs-keyword >for</span> ix=<span class=hljs-number >1</span>:size(C,<span class=hljs-number >1</span>), iy=<span class=hljs-number >1</span>:size(C,<span class=hljs-number >2</span>)])</code></pre>
<p>The halo update &#40;3.&#41; can be simply performed adding following line after the <code>compute&#33;</code> kernel</p>
<pre><code class="julia hljs">update_halo!(C)</code></pre>
<p>Now, when running on GPUs, it is possible to hide MPi communication behind computations&#33; This option implements as:</p>
<pre><code class="julia hljs"><span class=hljs-meta >@hide_communication</span> (<span class=hljs-number >8</span>, <span class=hljs-number >2</span>) <span class=hljs-keyword >begin</span>
    <span class=hljs-meta >@parallel</span> compute!(C2, C, D_dx, D_dy, dt, _dx, _dy, size_C1_2, size_C2_2)
    C, C2 = C2, C <span class=hljs-comment ># pointer swap</span>
    update_halo!(C)
<span class=hljs-keyword >end</span></code></pre>
<p>The <code>@hide_communication &#40;8, 2&#41;</code> will first compute the first and last 8 and 2 grid points in x and y dimension, respectively. Then, while exchanging boundaries the rest of the local domains computations will be perform &#40;overlapping the MPI communication&#41;.</p>
<p>To &#40;4.&#41; finalise the global grid,</p>
<pre><code class="julia hljs">finalize_global_grid()</code></pre>
<p>needs to be added before the <code>return</code> of the &quot;main&quot;.</p>
<p>The last changes to take car of is to &#40;5.&#41; handle visualisation in an appropriate fashion. Here, several options exists.</p>
<ul>
<li><p>One approach would for each local process to dump the local domain results to a file &#40;with process ID in the filename&#41; in order to reconstruct to global grid with a post-processing visualisation script &#40;as done in the previous examples&#41;. Libraries like, e.g., <a href="https://adios2.readthedocs.io/en/latest">ADIOS2</a> may help out there.</p>

<li><p>Another approach would be to gather the global grid results on a master process before doing further steps as disk saving or plotting.</p>

</ul>
<p>To implement the latter and generate a .gif, one needs to define a global array for visualisation:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >if</span> do_visu
    <span class=hljs-keyword >if</span> (me==<span class=hljs-number >0</span>) <span class=hljs-literal >ENV</span>[<span class=hljs-string >&quot;GKSwstype&quot;</span>]=<span class=hljs-string >&quot;nul&quot;</span>; <span class=hljs-keyword >if</span> isdir(<span class=hljs-string >&quot;viz2D_mxpu_out&quot;</span>)==<span class=hljs-literal >false</span> mkdir(<span class=hljs-string >&quot;viz2D_mxpu_out&quot;</span>) <span class=hljs-keyword >end</span>; loadpath = <span class=hljs-string >&quot;./viz2D_mxpu_out/&quot;</span>; anim = Animation(loadpath,<span class=hljs-built_in >String</span>[]); println(<span class=hljs-string >&quot;Animation directory: <span class=hljs-subst >$(anim.dir)</span>&quot;</span>) <span class=hljs-keyword >end</span>
    nx_v, ny_v = (nx-<span class=hljs-number >2</span>)*dims[<span class=hljs-number >1</span>], (ny-<span class=hljs-number >2</span>)*dims[<span class=hljs-number >2</span>]
    <span class=hljs-keyword >if</span> (nx_v*ny_v*sizeof(Data.<span class=hljs-built_in >Number</span>) &gt; <span class=hljs-number >0.8</span>*Sys.free_memory()) error(<span class=hljs-string >&quot;Not enough memory for visualization.&quot;</span>) <span class=hljs-keyword >end</span>
    C_v   = zeros(nx_v, ny_v) <span class=hljs-comment ># global array for visu</span>
    C_inn = zeros(nx-<span class=hljs-number >2</span>, ny-<span class=hljs-number >2</span>) <span class=hljs-comment ># no halo local array for visu</span>
    Xi_g, Yi_g = <span class=hljs-built_in >LinRange</span>(dx+dx/<span class=hljs-number >2</span>, Lx-dx-dx/<span class=hljs-number >2</span>, nx_v), <span class=hljs-built_in >LinRange</span>(dy+dy/<span class=hljs-number >2</span>, Ly-dy-dy/<span class=hljs-number >2</span>, ny_v) <span class=hljs-comment ># inner points only</span>
<span class=hljs-keyword >end</span></code></pre>
<p>Then, the plotting routine can be adapted to first gather the inner points of the local domains into the global array &#40;using <code>gather&#33;</code> function&#41; and then plot and/or save the global array &#40;here <code>C_v</code>&#41; from the master process <code>me&#61;&#61;0</code>:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># Visualize</span>
<span class=hljs-keyword >if</span> do_visu &amp;&amp; (it % nout == <span class=hljs-number >0</span>)
    C_inn .= C[<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>,<span class=hljs-number >2</span>:<span class=hljs-keyword >end</span>-<span class=hljs-number >1</span>]; gather!(C_inn, C_v)
    <span class=hljs-keyword >if</span> (me==<span class=hljs-number >0</span>)
        opts = (aspect_ratio=<span class=hljs-number >1</span>, xlims=(Xi_g[<span class=hljs-number >1</span>], Xi_g[<span class=hljs-keyword >end</span>]), ylims=(Yi_g[<span class=hljs-number >1</span>], Yi_g[<span class=hljs-keyword >end</span>]), clims=(<span class=hljs-number >0.0</span>, <span class=hljs-number >1.0</span>), c=:davos, xlabel=<span class=hljs-string >&quot;Lx&quot;</span>, ylabel=<span class=hljs-string >&quot;Ly&quot;</span>, title=<span class=hljs-string >&quot;time = <span class=hljs-subst >$(round(it*dt, sigdigits=<span class=hljs-number >3</span>)</span>)&quot;</span>)
        heatmap(Xi_g, Yi_g, <span class=hljs-built_in >Array</span>(C_v)&#x27;; opts...); frame(anim)
    <span class=hljs-keyword >end</span>
<span class=hljs-keyword >end</span></code></pre>
<p>To finally generate the .gif, one needs to place the following after the time loop:</p>
<pre><code class="julia hljs"><span class=hljs-keyword >if</span> (do_visu &amp;&amp; me==<span class=hljs-number >0</span>) gif(anim, <span class=hljs-string >&quot;diffusion_2D_mxpu.gif&quot;</span>, fps = <span class=hljs-number >5</span>)  <span class=hljs-keyword >end</span></code></pre>
<p>You can find the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/tree/main/scripts/diffusion_2D_perf_multixpu.jl"><code>diffusion_2D_perf_multixpu.jl</code></a> script in the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/tree/main/scripts">script/</a> folder.</p>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >We here did not rely on CUDA-aware MPI. However, we can use this feature in the final projects. Note that the examples using ImplicitGlobalGrid.jl would also work if <code>USE_GPU &#61; false</code>; however, the communication and computation overlap feature is then currently not yet available as its implementation relies at present on leveraging CUDA streams.</div></div>
<div class=warning ><div class=title >⚠️ Warning&#33;</div>
<div class=messg >Because of an issue most probably with CUDA.jl, you&#39;ll need to rely on CUDA.jl v3.3.6 when using ImplicitGlobalGrid.jl without CUDA-aware MPI &#40;as we are doing here&#41;. To enforce this compatibility, type <code>add CUDA@v3.3.6</code> whithin the REPL in package mode in your project &#40;having ensured to launch Julia with the <code>--project</code> flag&#41;.</div></div>
<h2 id=towards_stokes_ii_navier-stokes_flow ><a href="#towards_stokes_ii_navier-stokes_flow" class=header-anchor >Towards Stokes II: Navier-Stokes flow</a></h2>
<p>Previously, in lecture 7, we programmed an elastic wave solver building upon the acoustic wave from lecture 3 and adding information about elastic shear rheology.</p>
<p>In this final section, we will see how to turn the elastic wave solver into a weakly compressible viscous flow solver with inertia - a problem part of the <a href="https://en.wikipedia.org/wiki/Navier–Stokes_equations">Navier-Stokes equations</a>. From this point, we could turn transient physics into numerics and use the solver to converge an incompressible viscous Stokes flow to the steady state.</p>
<p>The weakly compressible <a href="https://en.wikipedia.org/wiki/Navier–Stokes_equations">Navier-Stokes equations</a> expressed in terms of velocities and pressure reads as following:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mi>K</mi><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂P}{∂t} = -K ∇_k v_k ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord >−</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>τ</mi><mo>=</mo><mi>μ</mi><mrow><mo fence=true >(</mo><msub><mi mathvariant=normal >∇</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> τ = μ\left(∇_i v_j + ∇_j v_i -\frac{1}{3} δ_{ij} ∇_k v_k \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord mathnormal">μ</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>ρ</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>v</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><mrow><mo fence=true >(</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>P</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> ρ \frac{∂v_i}{∂t} = ∇_j \left( τ_{ij} - P δ_{ij} \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord mathnormal">ρ</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> is the pressure, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> the velocity, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> the bulk modulus, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">μ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span> the viscosity, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">τ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> the viscous deviatoric stress tensor, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">ρ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">ρ</span></span></span></span> the density, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta_{ij}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> the Kronecker delta.</p>
<p>The incompressible Stokes flow represent the incompressible limit of the Navier-Stokes equation and can be formulated as following:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mn>0</mn><mo>=</mo><mo>−</mo><mi>K</mi><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> 0 = -K ∇_k v_k ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord >−</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>τ</mi><mo>=</mo><mi>μ</mi><mrow><mo fence=true >(</mo><msub><mi mathvariant=normal >∇</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> τ = μ\left(∇_i v_j + ∇_j v_i -\frac{1}{3} δ_{ij} ∇_k v_k \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord mathnormal">μ</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mn>0</mn><mo>=</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><mrow><mo fence=true >(</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>P</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> 0 = ∇_j \left( τ_{ij} - P δ_{ij} \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >0</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<p>These equations represent a steady state for which a viscous flow stress can be computed. Since all physical transient terms vanish, incompressible viscous Stokes problems are considered stiff requiring implicit type of methods to achieve a solution.</p>
<p>However, an iterative solutions to incompressible Stokes equations can be achieved using the second-order pseudo-transient method, as seen in <a href="/lecture4/#implicit_solutions">Lecture 4</a>.</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mn>1</mn><msub><mi>K</mi><mi>τ</mi></msub></mfrac><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>τ</mi></mrow></mfrac><mo>=</mo><mo>−</mo><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{1}{K_τ} \frac{∂P}{∂τ} = - ∇_k v_k ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.20744em;vertical-align:-0.8360000000000001em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.3139999999999996em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord >−</span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>τ</mi><mo>=</mo><mi>μ</mi><mrow><mo fence=true >(</mo><msub><mi mathvariant=normal >∇</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> τ = μ\left(∇_i v_j + ∇_j v_i -\frac{1}{3} δ_{ij} ∇_k v_k \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord mathnormal">μ</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><msubsup><mi>v</mi><mi>i</mi><mn>2</mn></msubsup></mrow><mrow><mi mathvariant=normal >∂</mi><msup><mi>τ</mi><mn>2</mn></msup></mrow></mfrac><mo>+</mo><msub><mi>ρ</mi><mi>τ</mi></msub><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>v</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>τ</mi></mrow></mfrac><mo>=</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><mrow><mo fence=true >(</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>P</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂v^2_i}{∂τ^2} + ρ_τ \frac{∂v_i}{∂τ} = ∇_j \left( τ_{ij} - P δ_{ij} \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.177108em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.491108em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.258664em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mord mathnormal">ρ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant=normal >∂</mi><mi>τ</mi></mrow><annotation encoding="application/x-tex">∂τ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.69444em;vertical-align:0em;"></span><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>τ</mi></msub></mrow><annotation encoding="application/x-tex">K_τ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>τ</mi></msub></mrow><annotation encoding="application/x-tex">ρ_τ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">ρ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.1132em;">τ</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> represent now numerical iterative parameters one can tune in order to reach the steady state as fast as possible.</p>
<p>One of your homework task for this lecture is to transform the Navier-Cauchy elastic wave solver into a weakly compressible &#40;viscous&#41; Navier-Stokes solver. See <a href="#exercise_3_-_navier-stokes_flow">Exercise 3</a> for a detailed task description.</p>
<h3 id=wrapping_up ><a href="#wrapping_up" class=header-anchor >Wrapping up</a></h3>
<p>Let&#39;s recall what we learned today about distributed computing in Julia using GPUs:</p>
<ul>
<li><p>We used fake parallelisation to understand the correct boundary exchange procedure.</p>

<li><p>We implemented 1D and 2D diffusion solvers in Julia using MPI for distributed memory parallelisation on both CPUs and GPUs &#40;using blocking messages&#41;.</p>

<li><p>We saw how combining <code>ParallelStencil.jl</code> with <code>ImplicitGlobalGrid.jl</code> permits to implement distributed memory parallelisation on multiple CPU and GPUs.</p>

</ul>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<h1 id=documenting_your_code ><a href="#documenting_your_code" class=header-anchor >Documenting your code</a></h1>
<p>This lecture we will learn:</p>
<ul>
<li><p>documentation vs code-comments</p>

<li><p>why to write documentation</p>

<li><p>some Julia tools:</p>
<ul>
<li><p>docstrings</p>

<li><p><a href="https://github.com/JuliaDocs/Documenter.jl">https://github.com/JuliaDocs/Documenter.jl</a></p>

<li><p><a href="https://github.com/fredrikekre/Literate.jl">https://github.com/fredrikekre/Literate.jl</a></p>

</ul>

</ul>
<p><img src="https://pcweenies.com/wp-content/uploads/2012/01/2012-01-12_pcw.jpg" alt=comic  /></p>
<h3 id=why_should_i_document_my_code ><a href="#why_should_i_document_my_code" class=header-anchor >Why should I document my code?</a></h3>
<p>Why should I write code comments?</p>
<ul>
<li><p><a href="https://blog.codinghorror.com/code-tells-you-how-comments-tell-you-why/">&quot;Code Tells You How, Comments Tell You Why&quot;</a></p>
<ul>
<li><p>code should be made understandable by itself, as much as possible</p>

<li><p>comments then should be to tell the &quot;why&quot; you&#39;re doing something</p>

</ul>

<li><p><em>but</em> I do a lot of structuring comments as well</p>

<li><p>math-y variables tend to be short and need a comment as well</p>

</ul>
<p>Why should I write documentation?</p>
<ul>
<li><p>documentation should give a bigger overview of what your code does</p>
<ul>
<li><p>at the function-level &#40;doc-strings&#41;</p>

<li><p>at the package-level &#40;README, full-fledged documentation&#41;</p>

</ul>

<li><p>to let other people and your future self &#40;probably most important&#41; understand what your code is about</p>

</ul>
<h3 id=documentation_easily_rots ><a href="#documentation_easily_rots" class=header-anchor >Documentation easily rots...</a></h3>
<p>Worse than no documentation/code comments is documentation which is outdated.</p>
<p>I find the best way to keep documentation up to date is:</p>
<ul>
<li><p>have documentation visible to you, e.g. GitHub README</p>

<li><p>document what you need yourself</p>

<li><p>use examples and run them as part of CI &#40;doc-tests, example-scripts&#41;</p>

</ul>
<h3 id=documentation_tools_doc-strings ><a href="#documentation_tools_doc-strings" class=header-anchor >Documentation tools: doc-strings</a></h3>
<p>A Julia doc-string &#40;<a href="https://docs.julialang.org/en/v1/manual/documentation/">Julia manual</a>&#41;:</p>
<ul>
<li><p>is just a string before the object &#40;no new-line&#41;; interpreted as markdown-string</p>

<li><p>can be attached to most things &#40;functions, variables, modules, macros, types&#41;</p>

<li><p>can be queried with <code>?</code></p>

</ul>
<pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    transform(r, θ) = (r*cos(θ), r*sin(θ))

Transform polar to cartesian coordinates.
&quot;&quot;&quot;</span>
transform(r, θ) = (r*cos(θ), r*sin(θ))

<span class=hljs-string >&quot;Typical size of beer crate&quot;</span>
<span class=hljs-keyword >const</span> BEERBOX = <span class=hljs-number >12</span></code></pre>
<pre><code class="julia hljs">?BEERBOX</code></pre>
<h3 id=documentation_tools_doc-strings_with_examples ><a href="#documentation_tools_doc-strings_with_examples" class=header-anchor >Documentation tools: doc-strings with examples</a></h3>
<p>One can add examples to doc-strings &#40;they can even be part of testing: <a href="https://juliadocs.github.io/Documenter.jl/stable/man/doctests/">doc-tests</a>&#41;.</p>
<ul>
<li><p>run it in the REPL and copy paste to the docstring</p>

</ul>
<pre><code class="julia hljs"><span class=hljs-string >&quot;&quot;&quot;
    transform(r, θ) = (r*cos(θ), r*sin(θ))

Transform polar to cartesian coordinates.

# Example
```jldoctest
julia&gt; transform(4.5, pi/5)
(3.6405764746872635, 2.6450336353161292)
```
&quot;&quot;&quot;</span>
transform(r, θ) = (r*cos(θ), r*sin(θ))</code></pre>
<pre><code class="julia hljs">?transform</code></pre>
<h3 id=documentation_tools_github_markdown_rendering ><a href="#documentation_tools_github_markdown_rendering" class=header-anchor >Documentation tools: Github markdown rendering</a></h3>
<p>The easiest way to write long-form documentation is to just use GitHub&#39;s markdown rendering.</p>
<p>A nice example is <a href="https://github.com/luraess/parallel-gpu-workshop-JuliaCon21#parallel-cpu-implementation">this short course</a> by Ludovic &#40;incidentally about solving PDEs on GPUs 🙂&#41;.</p>
<ul>
<li><p>images are rendered</p>

<li><p>in-page links are easy, e.g. <code>&#91;_back to workshop material_&#93;&#40;#workshop-material&#41;</code></p>

<li><p>top-left has a burger-menu for page navigation</p>

<li><p>can be edited within the web-page &#40;pencil-icon&#41;</p>

</ul>
<p>👉 this is a good and low-overhead way to produce pretty nice documentation</p>
<h3 id=documentation_tools_literatejl ><a href="#documentation_tools_literatejl" class=header-anchor >Documentation tools: Literate.jl</a></h3>
<p>There are several tools which render .jl files &#40;with special formatting&#41; into markdown files.  These files can then be added to Github and will be rendered there.</p>
<ul>
<li><p>we&#39;re using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a></p>

<li><p>format is described <a href="https://fredrikekre.github.io/Literate.jl/v2/fileformat/">here</a></p>

<li><p>files stay valid Julia scripts, i.e. they can be executed without Literate.jl</p>

</ul>
<p>Example</p>
<ul>
<li><p>output markdown in: <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00-L8Documentation.jl/blob/4bbeb3ddda046490847f050b02d3fc5d9308695b/scripts/car_travels.jl">course-101-0250-00-L8Documentation.jl: scripts/car_travels.jl</a></p>

<li><p>output markdown in: <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00-L8Documentation.jl/blob/4bbeb3ddda046490847f050b02d3fc5d9308695b/scripts/car_travels.md">course-101-0250-00-L8Documentation.jl: scripts/car_travels.md</a></p>

</ul>
<pre><code class="julia hljs">Literate.markdown(<span class=hljs-string >&quot;car_travels.jl&quot;</span>, directory_of_this_file, execute=<span class=hljs-literal >true</span>, documenter=<span class=hljs-literal >false</span>, credit=<span class=hljs-literal >false</span>)</code></pre>
<p>But this is not automatic&#33;  Manual steps: run Literate, add files, commit and push...</p>
<h3 id=documentation_tools_automating_literatejl ><a href="#documentation_tools_automating_literatejl" class=header-anchor >Documentation tools: Automating Literate.jl</a></h3>
<p>As is done on <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00-L8Documentation.jl">course-101-0250-00-L8Documentation.jl</a></p>
<pre><code class="yml hljs"><span class=hljs-attr >name:</span> <span class=hljs-string >Run</span> <span class=hljs-string >Literate.jl</span>
<span class=hljs-comment ># adapted from https://lannonbr.com/blog/2019-12-09-git-commit-in-actions</span>

<span class=hljs-attr >on:</span> <span class=hljs-string >push</span>

<span class=hljs-attr >jobs:</span>
  <span class=hljs-attr >lit:</span>
    <span class=hljs-attr >runs-on:</span> <span class=hljs-string >ubuntu-latest</span>
    <span class=hljs-attr >steps:</span>
      <span class=hljs-comment ># Checkout the branch</span>
      <span class=hljs-bullet >-</span> <span class=hljs-attr >uses:</span> <span class=hljs-string >actions/checkout@v2</span>

      <span class=hljs-bullet >-</span> <span class=hljs-attr >uses:</span> <span class=hljs-string >julia-actions/setup-julia@v1</span>
        <span class=hljs-attr >with:</span>
          <span class=hljs-attr >version:</span> <span class=hljs-string >&#x27;1.8&#x27;</span>
          <span class=hljs-attr >arch:</span> <span class=hljs-string >x64</span>

      <span class=hljs-bullet >-</span> <span class=hljs-attr >uses:</span> <span class=hljs-string >actions/cache@v1</span>
        <span class=hljs-attr >env:</span>
          <span class=hljs-attr >cache-name:</span> <span class=hljs-string >cache-artifacts</span>
        <span class=hljs-attr >with:</span>
          <span class=hljs-attr >path:</span> <span class=hljs-string >~/.julia/artifacts</span>
          <span class=hljs-attr >key:</span> <span class=hljs-string >${{</span> <span class=hljs-string >runner.os</span> <span class=hljs-string >}}-test-${{</span> <span class=hljs-string >env.cache-name</span> <span class=hljs-string >}}-${{</span> <span class=hljs-string >hashFiles(&#x27;**/Project.toml&#x27;)</span> <span class=hljs-string >}}</span>
          <span class=hljs-attr >restore-keys:</span> <span class=hljs-string >|
            ${{ runner.os }}-test-${{ env.cache-name }}-
            ${{ runner.os }}-test-
            ${{ runner.os }}-
</span>
      <span class=hljs-bullet >-</span> <span class=hljs-attr >uses:</span> <span class=hljs-string >julia-actions/julia-buildpkg@v1</span>

      <span class=hljs-bullet >-</span> <span class=hljs-attr >name:</span> <span class=hljs-string >run</span> <span class=hljs-string >Literate</span>
        <span class=hljs-attr >run:</span> <span class=hljs-string >julia</span> <span class=hljs-string >--color=yes</span> <span class=hljs-string >--project</span> <span class=hljs-string >-e</span> <span class=hljs-string >&#x27;cd(&quot;scripts&quot;); include(&quot;literate-script.jl&quot;)&#x27;</span>

      <span class=hljs-bullet >-</span> <span class=hljs-attr >name:</span> <span class=hljs-string >setup</span> <span class=hljs-string >git</span> <span class=hljs-string >config</span>
        <span class=hljs-attr >run:</span> <span class=hljs-string >|
          # setup the username and email. I tend to use &#x27;GitHub Actions Bot&#x27; with no email by default
          git config user.name &quot;GitHub Actions Bot&quot;
          git config user.email &quot;&lt;&gt;&quot;
</span>
      <span class=hljs-bullet >-</span> <span class=hljs-attr >name:</span> <span class=hljs-string >commit</span>
        <span class=hljs-attr >run:</span> <span class=hljs-string >|
          # Stage the file, commit and push
          git add scripts/md/*
          git commit -m &quot;Commit markdown files fom Literate&quot;
          git push origin master</span></code></pre>
<h3 id=documentation_tools_documenterjl ><a href="#documentation_tools_documenterjl" class=header-anchor >Documentation tools: Documenter.jl</a></h3>
<p>If you want to have full-blown documentation, including, e.g., automatic API documentation generation, versioning, then use <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a>.</p>
<p>Examples:</p>
<ul>
<li><p><a href="https://docs.julialang.org/en/v1/">https://docs.julialang.org/en/v1/</a></p>

<li><p><a href="https://mauro3.github.io/Parameters.jl/stable/">https://mauro3.github.io/Parameters.jl/stable/</a></p>

</ul>
<p><em><strong>Notes:</strong></em></p>
<ul>
<li><p>it&#39;s geared towards Julia-packages, less for a bunch-of-scripts as in our lecture</p>

<li><p>Documenter.jl also integrates with Literate.jl.</p>

<li><p>for more free-form websites, use <a href="https://github.com/tlienart/Franklin.jl">https://github.com/tlienart/Franklin.jl</a> &#40;as the course website does&#41;</p>

<li><p>if you want to use it, it&#39;s easiest to generate your package with <a href="https://github.com/invenia/PkgTemplates.jl">PkgTemplates.jl</a> which will generate the Documenter-setup for you.</p>

</ul>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<h1 id=exercises_-_lecture_8 ><a href="#exercises_-_lecture_8" class=header-anchor >Exercises - lecture 8</a></h1>
<div class=warning ><div class=title >⚠️ Warning&#33;</div>
<div class=messg >Exercises have to be handed in as monolithic Julia scripts &#40;one code per script&#41; and uploaded to your private &#40;shared&#41; GitHub repository, in a <strong>specific folder for each lecture</strong>. The git commit hash &#40;or SHA&#41; of the final push needs to be uploaded on Moodle &#40;<a href="/homework">more</a>&#41;.</div></div>
<h2 id=exercise_1_-_towards_distributed_memory_computing_on_gpus ><a href="#exercise_1_-_towards_distributed_memory_computing_on_gpus" class=header-anchor >Exercise 1 - <strong>Towards distributed memory computing on GPUs</strong></a></h2>
<p>👉 See <a href="/logistics/#submission">Logistics</a> for submission details.</p>
<p>The goal of this exercise is to:</p>
<ul>
<li><p>Familiarise with distributed computing</p>

<li><p>Learn about MPI on the way</p>

</ul>
<p>In this exercise, you will:</p>
<ul>
<li><p>finalise the fake parallelisation scripts discussed in lecture 8 &#40;2 procs and <code>n</code> procs&#41;</p>

<li><p>finalise the 2D Julia MPI script</p>

<li><p>Create a Julia MPI GPU version of the 2D Julia MPI script discussed <a href="#task_5_multi-gpu_homework">here</a></p>

</ul>
<p>Create a new folder in your GitHub repository for this week&#39;s &#40;lecture 8&#41; exercises.</p>
<h3 id=task_1 ><a href="#task_1" class=header-anchor >Task 1</a></h3>
<p>Finalise the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_1D_2procs.jl"><code>diffusion_1D_2procs.jl</code></a> and <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_1D_nprocs.jl"><code>diffusion_1D_nprocs.jl</code></a> script discussed during lecture 8. Make sure to correctly implement the halo update in order to exchange the internal boundaries among the fake parallel processes &#40;left and right and <code>ip</code> in the &quot;2procs&quot; and &quot;nprocs&quot; codes, respectively&#41;. See <a href="#fake_parallelisation">here</a> for details.</p>
<p>Report in two separate figures the final distribution of concentration <code>C</code> for both fake parallel codes. Include these figure in a first section of your lecture&#39;s 8 <code>README.md</code> adding a description sentence to each.</p>
<h3 id=task_2 ><a href="#task_2" class=header-anchor >Task 2</a></h3>
<p>Finalise the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_2D_mpi.jl"><code>diffusion_2D_mpi.jl</code></a> script discussed during lecture 8. In particular, finalise the <code>update_halo</code> functions to allow for correct internal boundary exchange among the distributed parallel MPI processes. Add the final code to your GitHub lecture 8 folder.</p>
<p>For each of the &#40;4&#41; neighbour exchanges:</p>
<ol>
<li><p>start by defining a sendbuffer <code>sendbuf</code> to hold the vector you need to send</p>

<li><p>initialise a receive buffer <code>recvbuf</code> to later hold the vector received from the corresponding neighbouring process</p>

<li><p>use <code>MPI.Send</code> and <code>MPI.Recv&#33;</code> functions to perform the boundary exchange</p>

<li><p>Assign the values within the receive buffer to the corresponding row or column of the array <code>A</code></p>

</ol>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >Apply similar overlap and halo update as in the fake parallelisation examples. Look-up <a href="https://juliaparallel.github.io/MPI.jl/latest/pointtopoint/#MPI.Send">MPI.Send</a> and <a href="https://juliaparallel.github.io/MPI.jl/latest/pointtopoint/#MPI.Recv&#33;">MPI.recv&#33;</a> for further details.</div></div>
<p>In a new section of your lecture&#39;s 8 <code>README.md</code>, add a .gif animation showing the diffusion of the quantity <code>C</code>, <strong>running on 4 MPI processes</strong>, for the physical and numerical parameters suggested in the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_2D_mpi.jl">initial file</a>. Add a short description of the results and provide the command used to launch the script in the <code>README.md</code> as well.</p>
<h3 id=task_3 ><a href="#task_3" class=header-anchor >Task 3</a></h3>
<p>Create a multi-GPU implementation of the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_2D_mpi.jl"><code>diffusion_2D_mpi.jl</code></a> script as suggested <a href="#task_5_multi-gpu_homework">here</a>. To this end, create a new script <code>diffusion_2D_mpi_gpu.jl</code> that you will upload to your lecture 8 GitHub repository upon completion.</p>
<p>Translate the <code>diffusion_2D_mpi.jl</code> code from exercise 1 &#40;task 3&#41; to GPU using GPU array programming. You can use a similar approach as in the CPU code to perform the boundary updates. You can use <code>copyto&#33;</code> function in order to copy the data from the GPU memory into the send buffers &#40;CPU memory&#41; or to copy the receive buffer data to the GPU array.</p>
<p>The steps to realise this task summarise as following:</p>
<ol>
<li><p>use GPU array initialisation &#40;<code>CUDA.zeros</code>, <code>CuArray&#40;&#41;</code>, ...&#41;</p>

<li><p>gather the GPU arrays back on the host memory for visualisation or saving &#40;using <code>Array&#40;&#41;</code>&#41;</p>

<li><p>modify the <code>update_halo</code> function; use <code>copyto&#33;</code> to copy device data to the host into the send buffer or to copy host data to the device from the receive buffer</p>

</ol>
<p>In a new &#40;3rd&#41; section of your lecture&#39;s 8 <code>README.md</code>, add .gif animation showing the diffusion of the quantity <code>C</code>, <strong>running on 4 GPUs &#40;MPI processes&#41;</strong>, for the physical and numerical parameters suggested in the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/diffusion_2D_mpi.jl">initial file</a>. Add a short description of the results and provide the command used to launch the script in the <code>README.md</code> as well. Note what changes were needed to go from CPU to GPU in this distributed solver.</p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_2_-_multi-xpu_computing ><a href="#exercise_2_-_multi-xpu_computing" class=header-anchor >Exercise 2 - <strong>Multi-XPU computing</strong></a></h2>
<p>👉 See <a href="/logistics/#submission">Logistics</a> for submission details.</p>
<p>The goal of this exercise is to:</p>
<ul>
<li><p>Familiarise with distributed computing</p>

<li><p>Combine <a href="https://github.com/eth-cscs/ImplicitGlobalGrid.jl">ImplicitGlobalGrid.jl</a> and <a href="https://github.com/omlins/ParallelStencil.jl">ParallelStencil.jl</a></p>

<li><p>Learn about GPU MPI on the way</p>

</ul>
<p>In this exercise, you will:</p>
<ul>
<li><p>Create a 2D multi-XPU acoustic wave solver</p>

<li><p>Make it XPU compatible using ParallelStencil.jl</p>

<li><p>Deploy it on multiple XPUs using ImplicitGlobalGrid.jl</p>

</ul>
<div class=warning ><div class=title >⚠️ Warning&#33;</div>
<div class=messg >Because of an issue most probably with CUDA.jl, you&#39;ll need to rely on CUDA.jl v3.3.6 when using ImplicitGlobalGrid.jl without CUDA-aware MPI &#40;as we are doing here&#41;. To enforce this compatibility, type <code>add CUDA@v3.3.6</code> whithin the REPL in package mode in your project &#40;having ensured to launch Julia with the <code>--project</code> flag&#41;.</div></div>
<h3 id=task_1__2 ><a href="#task_1__2" class=header-anchor >Task 1</a></h3>
<p>Starting from the <code>acoustic_2D_perf_xpu.jl</code> script you developed for exercise 2 &#40;lecture 7&#41; &#40;also available in the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/blob/main/scripts/">scripts/</a> folder after homework 7 due date&#41;, create a multi-XPU version adding ImplicitGlobalGrid features to run on multiple XPUs.</p>
<p>Follow the steps discussed in lecture 8 in the <a href="#using_implicitglobalgridjl">Using <code>ImplicitGlobalGrid.jl</code></a> Section.</p>
<p>Create a new <code>acoustic_2D_perf_mulixpu.jl</code> script with following physics and numerics parameters:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># Physics</span>
Lx, Ly  = <span class=hljs-number >10.0</span>, <span class=hljs-number >10.0</span>
ρ       = <span class=hljs-number >1.0</span>
K       = <span class=hljs-number >1.0</span>
ttot    = <span class=hljs-number >1e1</span>
<span class=hljs-comment ># Numerics</span>
nx, ny  = <span class=hljs-number >32</span>, <span class=hljs-number >32</span> <span class=hljs-comment ># number of grid points (local domain)</span>
nout    = <span class=hljs-number >10</span></code></pre>
<p>Add the &quot;hide communication&quot; feature using a a boundary width of <code>&#40;8,2&#41;</code> as such <code>@hide_communication &#40;8, 2&#41; begin ...</code></p>
<p>Add the same visualisation routine as for the multi-XPU diffusion example from lecture 8, automatically creating a .gif &#40;in this case for pressure <code>P</code> instead of concentration <code>C</code>&#41;. You can use the following plotting options</p>
<pre><code class="julia hljs">opts = (aspect_ratio=<span class=hljs-number >1</span>, xlims=(Xi_g[<span class=hljs-number >1</span>], Xi_g[<span class=hljs-keyword >end</span>]), ylims=(Yi_g[<span class=hljs-number >1</span>], Yi_g[<span class=hljs-keyword >end</span>]), clims=(-<span class=hljs-number >0.25</span>, <span class=hljs-number >0.25</span>), c=:davos, xlabel=<span class=hljs-string >&quot;Lx&quot;</span>, ylabel=<span class=hljs-string >&quot;Ly&quot;</span>, title=<span class=hljs-string >&quot;time = <span class=hljs-subst >$(round(it*dt, sigdigits=<span class=hljs-number >3</span>)</span>)&quot;</span>)
heatmap(Xi_g, Yi_g, <span class=hljs-built_in >Array</span>(P_v)&#x27;; opts...); frame(anim)</code></pre>
<h3 id=task_2__2 ><a href="#task_2__2" class=header-anchor >Task 2</a></h3>
<p>Execute the <code>acoustic_2D_perf_mulixpu.jl</code> on 4 GPUs &#40;on your octopus node&#41; to generate a .gif. Then, create a new section in the <code>README.md</code> of your lecture 8 GitHub repository and add the generated .gif. Including a short description of the results.</p>
<p>Here is a snapshot on what to expect:</p>
<div class=img-med ><img src="../assets/literate_figures/l8_acoustic_2D_mxpu_2.gif" alt="Acoustic 2D 4 procs" /></div>
<h3 id=task_3__2 ><a href="#task_3__2" class=header-anchor >Task 3</a></h3>
<p>Realise a weak scaling experiment on 1-4 Titan Xm GPUs on your node and report parallel efficiency.</p>
<p>Select the number of grid points for the local domain &#40;<code>nx</code>, <code>ny</code>&#41; to match the best <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mrow><mi mathvariant=normal >e</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">T_\mathrm{eff}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.83333em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> values reported in <a href="/lecture7/#task_3__2">Lecture 7 - Task 3</a>. Make sure to deactivate visualisation and adapt the total time <code>ttot</code> or the number of time steps <code>nt</code> such that the code executes in about one second.</p>
<p>Report the execution time <code>t1 &#61; t_toc</code> for the single GPU execution. Then, run the code on 1, 2, 3 and 4 GPUs saving the <code>t_toc</code> time for each run. Report the parallel efficiency by normalising the execution time <code>t_toc</code> for the 1-4 GPU runs by <code>t1</code>. Plot the results as function of number of GPUs.</p>
<p>Add the figure to a new section of the <code>README.md</code> and briefly discuss the results. Make sure to report to local problem size you used when performing the weak scaling test.</p>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_3_-_navier-stokes_flow ><a href="#exercise_3_-_navier-stokes_flow" class=header-anchor >Exercise 3 - <strong>Navier-Stokes flow</strong></a></h2>
<p>👉 See <a href="/logistics/#submission">Logistics</a> for submission details.</p>
<p>The goal of this exercise is to:</p>
<ul>
<li><p>Implement a viscous Stokes flow</p>

<li><p>Step from the Navier-Cauchy elastic wave solver to en explicit Navier-Stokes solver</p>

<li><p>Get a glimpse into fluid dynamics</p>

<li><p>Apply reference testing using <code>ReferenceTests.jl</code></p>

</ul>
<h3 id=getting_started ><a href="#getting_started" class=header-anchor >Getting started</a></h3>
<p>In this exercise your task will be to modify the elastic wave code <code>elastic_2D.jl</code> from <a href="/lecture7/#task_4_-_rearranging_the_code">Exercise 3, Lecture 7</a>, turning it into a weakly compressible viscous Navier-Stokes flow solver with inertia terms.</p>
<p>The main task will be to modify the shear rheology, now viscous. Viscosity &#91;Pa.s&#93; defines as the ratio between  stress <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">τ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> and strain-rate <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent=true ><mi>ε</mi><mo>˙</mo></mover></mrow><annotation encoding="application/x-tex">ε̇</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.66786em;vertical-align:0em;"></span><span class="mord accent"><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.66786em;"><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class="mord mathnormal">ε</span></span><span style="top:-3em;"><span class=pstrut  style="height:3em;"></span><span class=accent-body  style="left:-0.055550000000000016em;"><span class=mord >˙</span></span></span></span></span></span></span></span></span></span>.</p>
<p>In this lecture&#39;s Git repository, duplicate the <code>elastic_2D.jl</code> renaming it <code>viscous_NS_2D.jl</code>.</p>
<h3 id=task_1__3 ><a href="#task_1__3" class=header-anchor >Task 1</a></h3>
<p>Modify the physics in order to implement the weakly compressible Navier-Stokes equations:</p>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mfrac><mrow><mi mathvariant=normal >∂</mi><mi>P</mi></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><mo>−</mo><mi>K</mi><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> \frac{∂P}{∂t} = -K ∇_k v_k ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class=mord >−</span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace nobreak"> </span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>τ</mi><mo>=</mo><mi>μ</mi><mrow><mo fence=true >(</mo><msub><mi mathvariant=normal >∇</mi><mi>i</mi></msub><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mfrac><mn>1</mn><mn>3</mn></mfrac><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi mathvariant=normal >∇</mi><mi>k</mi></msub><msub><mi>v</mi><mi>k</mi></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> τ = μ\left(∇_i v_j + ∇_j v_i -\frac{1}{3} δ_{ij} ∇_k v_k \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="mord mathnormal">μ</span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >+</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.32144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >3</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord >1</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<span class=katex-display ><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML" display=block ><semantics><mrow><mi>ρ</mi><mfrac><mrow><mi mathvariant=normal >∂</mi><msub><mi>v</mi><mi>i</mi></msub></mrow><mrow><mi mathvariant=normal >∂</mi><mi>t</mi></mrow></mfrac><mo>=</mo><msub><mi mathvariant=normal >∇</mi><mi>j</mi></msub><mrow><mo fence=true >(</mo><msub><mi>τ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>P</mi><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence=true >)</mo></mrow><mtext> </mtext><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex"> ρ \frac{∂v_i}{∂t} = ∇_j \left( τ_{ij} - P δ_{ij} \right) ~,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord mathnormal">ρ</span><span class=mord ><span class="mopen nulldelimiter"></span><span class=mfrac ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:1.37144em;"><span style="top:-2.314em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class="mord mathnormal">t</span></span></span><span style="top:-3.23em;"><span class=pstrut  style="height:3em;"></span><span class=frac-line  style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class=pstrut  style="height:3em;"></span><span class=mord ><span class=mord  style="margin-right:0.05556em;">∂</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class=mspace  style="margin-right:0.2777777777777778em;"></span><span class=mrel >=</span><span class=mspace  style="margin-right:0.2777777777777778em;"></span></span><span class=base ><span class=strut  style="height:1.036108em;vertical-align:-0.286108em;"></span><span class=mord ><span class=mord >∇</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=minner ><span class="mopen delimcenter" style="top:0em;">(</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace nobreak"> </span><span class=mspace  style="margin-right:0.16666666666666666em;"></span><span class=mpunct >,</span></span></span></span></span>
<p>where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> is the pressure, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span> the velocity, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> the bulk modulus, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">μ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">μ</span></span></span></span> the viscosity, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">τ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> the viscous deviatoric stress tensor, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">ρ</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">ρ</span></span></span></span> the density, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\delta_{ij}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.980548em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03785em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span> the Kronecker delta.</p>
<p>Then, make sure the model runs using the following parameters:</p>
<pre><code class="julia hljs"><span class=hljs-comment ># Physics</span>
Lx, Ly = <span class=hljs-number >10.0</span>, <span class=hljs-number >10.0</span>
ρ      = <span class=hljs-number >1.0</span>
K      = <span class=hljs-number >1.0</span>
μ      = <span class=hljs-number >1.0</span>
ttot   = <span class=hljs-number >5.0</span>
<span class=hljs-comment ># Numerics</span>
nx, ny = <span class=hljs-number >128</span>, <span class=hljs-number >128</span></code></pre>
<p>Since the process is now viscous, think how to adapt the time step to ensure stability. You can guess it upon the analogy between diffusion and acoustic waves. Diffusive-like &#40;here viscous&#41; processes take a time step limiter in the form <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>∆</mtext><msup><mi>x</mi><mn>2</mn></msup><mi mathvariant=normal >/</mi><msub><mi>μ</mi><mrow><mi mathvariant=normal >e</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >f</mi></mrow></msub><mi mathvariant=normal >/</mi><msub><mi>n</mi><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >s</mi></mrow></msub><mi mathvariant=normal >/</mi><mn>2.1</mn></mrow><annotation encoding="application/x-tex">∆x^2/μ_\mathrm{eff}/n_\mathrm{dims}/2.1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.064108em;vertical-align:-0.25em;"></span><span class=mord >∆</span><span class=mord ><span class="mord mathnormal">x</span><span class=msupsub ><span class=vlist-t ><span class=vlist-r ><span class=vlist  style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class=mord >/</span><span class=mord ><span class="mord mathnormal">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord >2</span><span class=mord >.</span><span class=mord >1</span></span></span></span>, while wave-like &#40;elastic&#41; processes take a time step limiter in the form <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>∆</mtext><mi>x</mi><mi mathvariant=normal >/</mi><msub><mi>v</mi><mrow><mi mathvariant=normal >e</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >f</mi></mrow></msub><mi mathvariant=normal >/</mi><mn>2.1</mn><mo separator=true >,</mo></mrow><annotation encoding="application/x-tex">∆x/v_\mathrm{eff}/2.1,</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1em;vertical-align:-0.25em;"></span><span class=mord >∆</span><span class="mord mathnormal">x</span><span class=mord >/</span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span><span class=mord >/</span><span class=mord >2</span><span class=mord >.</span><span class=mord >1</span><span class=mpunct >,</span></span></span></span> where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi mathvariant=normal >e</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">μ_\mathrm{eff}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.625em;vertical-align:-0.19444em;"></span><span class=mord ><span class="mord mathnormal">μ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mrow><mi mathvariant=normal >d</mi><mi mathvariant=normal >i</mi><mi mathvariant=normal >m</mi><mi mathvariant=normal >s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">n_\mathrm{dims}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal">n</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">d</span><span class="mord mathrm mtight">i</span><span class="mord mathrm mtight">m</span><span class="mord mathrm mtight">s</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi mathvariant=normal >e</mi><mi mathvariant=normal >f</mi><mi mathvariant=normal >f</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v_\mathrm{eff}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathrm mtight">e</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span><span class="mord mathrm mtight" style="margin-right:0.07778em;">f</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> represent the effective viscosity, the number of spacial dimensions and an effective wave speed, respectively.</p>
<p>In this particular case, we could use</p>
<pre><code class="julia hljs">dt = min(dx,dy)^<span class=hljs-number >2</span>/(K + <span class=hljs-number >4</span>/<span class=hljs-number >3</span>*μ)/ρ/<span class=hljs-number >4.1</span></code></pre>
<p>Also, add the possibility of deactivating visualisation.</p>
<h3 id=task_2__3 ><a href="#task_2__3" class=header-anchor >Task 2</a></h3>
<p>In a new section of the <code>README.md</code> add a figure from code featuring 4 subplots depicting pressure <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span>, velocity x-component <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">v_x</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, normal and shear stress components, <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>x</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\tau_{xx}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.58056em;vertical-align:-0.15em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>τ</mi><mrow><mi>x</mi><mi>y</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\tau_{xy}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.716668em;vertical-align:-0.286108em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.1132em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>, respectively, and a short description.</p>
<h3 id=task_3__3 ><a href="#task_3__3" class=header-anchor >Task 3</a></h3>
<p>Add reference testing and set up Continuous Integration with GitHub Actions.</p>
<p>Perform the following tasks, applying reference testing to the <code>viscous_NS_2D.jl</code> script:</p>
<ul>
<li><p>Make sure your Lecture 8 GitHub repo is set up as a Julia project, i.e. it contains <code>.toml</code> files, and <code>src</code> and <code>test</code> folders &#40;you could use the <code>generate</code> command of the REPL package-mode&#41;.</p>

<li><p>add <code>viscous_NS_2D.jl</code> to a <code>scripts/</code> folder</p>

<li><p>You can deactivate the plotting.  This will make the tests run faster.  Also return the final <code>P</code> and <code>xc</code> from the function.</p>

<li><p>Make a <code>ReferenceTest.jl</code> which tests the value at 12 random indices of <code>P</code> against a truth, the truth being the <code>reftest-files/X.bson</code> file you should download and unzip from the <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/tree/main/scripts/reftest-files.zip">course-101-0250-00/scripts/</a> folder &#40;<strong>make sure to place the <code>X.bson</code> in your <code>reftest-files</code> folder</strong>&#41;. The reference test used to generate the <code>X.bson</code> file is following &#40;feel free to recycle it for your tests&#41;:</p>

</ul>
<pre><code class="julia hljs"><span class=hljs-keyword >using</span> Test, ReferenceTests, BSON

include(<span class=hljs-string >&quot;./viscous_NS_2D.jl&quot;</span>)

<span class=hljs-comment >## Reference Tests with ReferenceTests.jl</span>
<span class=hljs-comment ># We put both arrays xc and P into a BSON.jl and then compare them</span>

<span class=hljs-string >&quot;Compare all dict entries&quot;</span>
comp(d1, d2) = keys(d1) == keys(d2) &amp;&amp; all([ v1≈v2 <span class=hljs-keyword >for</span> (v1,v2) <span class=hljs-keyword >in</span> zip(values(d1), values(d2))])

X, P, = viscous_2D()

inds = <span class=hljs-built_in >Int</span>.(ceil.(<span class=hljs-built_in >LinRange</span>(<span class=hljs-number >1</span>, length(X), <span class=hljs-number >12</span>)))

d = <span class=hljs-built_in >Dict</span>(:X=&gt; X[inds], :P=&gt;P[inds])

<span class=hljs-meta >@testset</span> <span class=hljs-string >&quot;Ref-tests&quot;</span> <span class=hljs-keyword >begin</span>
<span class=hljs-meta >@test_reference</span> <span class=hljs-string >&quot;reftest-files/X.bson&quot;</span> d by=comp
<span class=hljs-keyword >end</span></code></pre>
<div class=note ><div class=title >💡 Note</div>
<div class=messg >Remember to check-in all the files into the repo; in particular the reference <code>*.bson</code>.</div></div>
<p>GitHub Actions and CI:</p>
<ul>
<li><p>Make sure that all tests run and pass when called via package-mode <code>test</code></p>

<li><p>Follow/revisit the Lecture 7 and in particular look at the example at <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00-L6Testing.jl">https://github.com/eth-vaw-glaciology/course-101-0250-00-L6Testing.jl</a> and <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00-L6Testing-subfolder.jl">https://github.com/eth-vaw-glaciology/course-101-0250-00-L6Testing-subfolder.jl</a> to setup CI</p>

<li><p>Push to GitHub and make sure the CI runs and passes</p>

<li><p>Add the CI-badge to the <code>README.md</code></p>

</ul>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<hr />
<h2 id=exercise_4_-_automatic_documentation_in_julia ><a href="#exercise_4_-_automatic_documentation_in_julia" class=header-anchor >Exercise 4 - <strong>Automatic documentation in Julia</strong></a></h2>
<p>👉 See <a href="/logistics/#submission">Logistics</a> for submission details.</p>
<p>The goal of this exercise is to:</p>
<ul>
<li><p>write some documentation</p>
<ul>
<li><p>using <a href="https://docs.julialang.org/en/v1/manual/documentation/">doc-strings</a></p>

<li><p>using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a></p>

</ul>

</ul>
<p>One task you&#39;ve already done, namely to update the README.md of this set of exercises&#33;</p>
<p>Tasks:</p>
<ul>
<li><p>add doc-string to the functions you created for this exercise</p>

<li><p>turn the script of Exercise 3 into a Literate.jl script. Compile it to markdown, git-add the output &#40;both <code>.md</code>-file and any figures&#41; and push it.</p>

</ul>

<p><a href="#content">⤴ <em><strong>back to Content</strong></em></a></p>
<div class=page-foot >
  <div class=copyright >
    <a href="https://github.com/eth-vaw-glaciology/course-101-0250-00/"><b>Edit this page on <img class=github-logo  src="https://unpkg.com/ionicons@5.1.2/dist/svg/logo-github.svg"></b></a><br>
    Last modified: October 05, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
    </div>